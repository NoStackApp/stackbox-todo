"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var React=require("react"),React__default=_interopDefault(React),reactComponents=require("@apollo/react-components"),reactCommon=require("@apollo/react-common"),PropTypes=_interopDefault(require("prop-types")),styled=_interopDefault(require("styled-components")),Graph=_interopDefault(require("react-graph-vis")),reactHoc=require("@apollo/react-hoc"),uuid=require("uuid"),compose=_interopDefault(require("@shopify/react-compose")),formik=require("formik"),apolloLinkContext=require("apollo-link-context"),apolloLinkHttp=require("apollo-link-http"),axios=_interopDefault(require("axios")),jwt=_interopDefault(require("jsonwebtoken")),extendStatics=function(e,n){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};function __extends(e,n){function t(){this.constructor=e}extendStatics(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var __assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function __awaiter(e,n,t,a){return new(t||(t=Promise))(function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function d(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new t(function(n){n(e.value)}).then(o,d)}l((a=a.apply(e,n||[])).next())})}function __generator(e,n){var t,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function d(r){return function(d){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=n.call(e,o)}catch(e){r=[6,e],a=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,d])}}}function __makeTemplateObject(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e}var EXECUTE_ACTION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"EXECUTE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"unrestricted"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"ExecuteAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"actionId"},value:{kind:"Variable",name:{kind:"Name",value:"actionId"}}},{kind:"Argument",name:{kind:"Name",value:"executionParameters"},value:{kind:"Variable",name:{kind:"Name",value:"executionParameters"}}},{kind:"Argument",name:{kind:"Name",value:"unrestricted"},value:{kind:"Variable",name:{kind:"Name",value:"unrestricted"}}}],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:250,source:{body:"\n  mutation EXECUTE_ACTION(\n    $actionId: ID!\n    $executionParameters: String\n    $unrestricted: Boolean\n  ) {\n    ExecuteAction(\n      actionId: $actionId\n      executionParameters: $executionParameters\n      unrestricted: $unrestricted\n    )\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},CREATE_INSTANCE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceID"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"parentInstanceId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:353,source:{body:"\n  mutation CREATE_INSTANCE(\n    $id: ID!\n    $value: String\n    $typeId: ID!\n    $parentId: ID!\n    $parentTypeId: ID!\n    $treeId: ID!\n  ) {\n    AddInstance(\n      typeId: $typeId\n      instanceID: $id\n      value: $value\n      parentTypeId: $parentTypeId\n      parentInstanceId: $parentId\n      treeId: $treeId\n    ) {\n      id\n      value\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},ASSOCIATE_INSTANCES={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ASSOCIATE_INSTANCES"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"secondInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeAssnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"CreateInstanceAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:{kind:"Name",value:"addAssnToFirstInstance"},name:{kind:"Name",value:"AddInstanceInstanceAssns"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"firstInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:{kind:"Name",value:"addAssnToSecondInstance"},name:{kind:"Name",value:"AddInstanceInstanceAssns"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"secondInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddInstanceAssnAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnid"},value:{kind:"Variable",name:{kind:"Name",value:"typeAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:603,source:{body:"\n  mutation ASSOCIATE_INSTANCES(\n    $firstInstanceId: ID!\n    $secondInstanceId: ID!\n    $instanceAssnId: ID!\n    $typeAssnId: ID!\n  ) {\n    CreateInstanceAssn(id: $instanceAssnId) {\n      id\n    }\n\n    addAssnToFirstInstance: AddInstanceInstanceAssns(\n      instanceid: $firstInstanceId\n      instanceassnid: $instanceAssnId\n    ) {\n      id\n    }\n\n    addAssnToSecondInstance: AddInstanceInstanceAssns(\n      instanceid: $secondInstanceId\n      instanceassnid: $instanceAssnId\n    ) {\n      id\n    }\n\n    AddInstanceAssnAssn(instanceassnid: $instanceAssnId, assnid: $typeAssnId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},UPDATE_INSTANCE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"UpdateInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"order"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:174,source:{body:"\n  mutation UPDATE_INSTANCE($id: ID!, $value: String, $order: Float) {\n    UpdateInstance(id: $id, value: $value, order: $order) {\n      id\n      value\n      order\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DELETE_INSTANCE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"RemoveInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceID"},value:{kind:"Variable",name:{kind:"Name",value:"instanceId"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"parentInstanceId"},value:{kind:"Variable",name:{kind:"Name",value:"parentInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:320,source:{body:"\n  mutation DELETE_INSTANCE(\n    $typeId: ID!\n    $instanceId: ID!\n    $parentTypeId: ID!\n    $parentInstanceId: ID!\n    $treeId: ID!\n  ) {\n    RemoveInstance(\n      typeId: $typeId\n      instanceID: $instanceId\n      parentTypeId: $parentTypeId\n      parentInstanceId: $parentInstanceId\n      treeId: $treeId\n    )\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},REGISTER_USER={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"REGISTER_USER"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userClass"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"username"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"lastName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"password"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"user"},name:{kind:"Name",value:"CreateUserOnPlatform"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}},{kind:"Argument",name:{kind:"Name",value:"userClass"},value:{kind:"Variable",name:{kind:"Name",value:"userClass"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"username"}}},{kind:"Argument",name:{kind:"Name",value:"firstName"},value:{kind:"Variable",name:{kind:"Name",value:"firstName"}}},{kind:"Argument",name:{kind:"Name",value:"lastName"},value:{kind:"Variable",name:{kind:"Name",value:"lastName"}}},{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}},{kind:"Argument",name:{kind:"Name",value:"password"},value:{kind:"Variable",name:{kind:"Name",value:"password"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:464,source:{body:"\n  mutation REGISTER_USER(\n    $id: ID!\n    $platformId: ID!\n    $userClass: ID!\n    $username: String!\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n    $password: String!\n  ) {\n    user: CreateUserOnPlatform(\n      id: $id\n      platformId: $platformId\n      userClass: $userClass\n      name: $username\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n      password: $password\n    ) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},_a=React.createContext({platformId:null,currentUser:null,client:void 0,loading:!0,login:function(){},logout:function(){}}),Provider=_a.Provider,Consumer=_a.Consumer,NoStackConsumer=function(e){var n=e.children;return React__default.createElement(Consumer,null,function(e){if(void 0===e)throw new Error("NoStackConsumer must be used within a NoStackProvider.");return n(e)})},RawNoStackProvider=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={currentUser:null,loading:!0},n.setUser=function(e,t,a,i){return n.setState({currentUser:{id:e,username:t,role:a,accessToken:i}})},n.logout=function(e){var t=n.props.client;localStorage.clear(),t.resetStore(),n.setState({currentUser:null},e)},n.login=function(e){var t=e.username,a=e.password;return __awaiter(n,void 0,void 0,function(){var e,n,i,r,o,d;return __generator(this,function(l){switch(l.label){case 0:return e=this.props,n=e.loginUser,i=e.platformId,r=JSON.stringify({userName:t,password:a,platformId:i}),[4,n({variables:{actionId:"a0d89c1f-c423-45e0-9339-c719dcbb7afe",executionParameters:r,unrestricted:!0}}).catch(function(e){return{error:e}})];case 1:if((o=l.sent()).error||!o.data||!o.data.ExecuteAction){if(o.error.networkError)throw o.error.networkError;if(o.error.graphQLErrors)throw o.error.graphQLErrors[0];throw new Error("Unknown error.")}if(!((d=JSON.parse(o.data.ExecuteAction)).id&&d.userId&&d.userName&&d.role&&d.AuthenticationResult&&d.AuthenticationResult.AccessToken&&d.AuthenticationResult.RefreshToken))throw new Error("Unknown error.");return this.setUser(d.userId,d.userName,d.role,d.AuthenticationResult.AccessToken),[4,localStorage.setItem("accessToken",d.AuthenticationResult.AccessToken)];case 2:return l.sent(),[4,localStorage.setItem("refreshToken",d.AuthenticationResult.RefreshToken)];case 3:return l.sent(),[2,d]}})})},n}return __extends(n,e),n.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,this.loginWithToken()];case 1:return e=n.sent(),[3,5];case 2:return n.sent(),[4,this.refreshToken()];case 3:return n.sent(),[4,this.loginWithToken()];case 4:return e=n.sent(),[3,5];case 5:return e&&this.setUser(e.id,e.username,e.role,e.accessToken),this.setState({loading:!1}),[2]}})})},n.prototype.refreshToken=function(){return __awaiter(this,void 0,void 0,function(){var e,n,t,a,i,r,o;return __generator(this,function(d){switch(d.label){case 0:return e=this.props,n=e.loginUser,t=e.platformId,(a=localStorage.getItem("refreshToken"))?(i=JSON.stringify({refreshToken:a,platformId:t}),[4,n({variables:{actionId:"96d3be63-53c5-418e-9167-71e3d43271e3",executionParameters:i,unrestricted:!0}}).catch(function(e){return{error:e}})]):[2,this.logout()];case 1:return!(r=d.sent()).error&&r.data&&r.data.ExecuteAction&&((o=JSON.parse(r.data.ExecuteAction)).id&&o.AuthenticationResult&&o.AuthenticationResult.AccessToken)?[4,localStorage.setItem("accessToken",o.AuthenticationResult.AccessToken)]:[2,this.logout()];case 2:return d.sent(),[2,o.AuthenticationResult.AccessToken]}})})},n.prototype.loginWithToken=function(){return __awaiter(this,void 0,void 0,function(){var e,n,t,a,i,r,o;return __generator(this,function(d){switch(d.label){case 0:return e=this.props,n=e.loginUser,t=e.platformId,[4,localStorage.getItem("accessToken")];case 1:return(a=d.sent())?(i=JSON.stringify({accessToken:a,platformId:t}),[4,n({variables:{actionId:"1279e113-d70f-4a95-9890-a5cebd344f3d",executionParameters:i,unrestricted:!0}}).catch(function(e){return{error:e}})]):[2,this.logout()];case 2:if((r=d.sent()).error||!r.data||!r.data.ExecuteAction)throw new Error("Expired/Invalid Token");if(!((o=JSON.parse(r.data.ExecuteAction)).id&&o.userId&&o.role&&o.accessToken))throw new Error("Expired/Invalid Token");return[2,{id:o.userId,role:o.role,username:o.userName,accessToken:o.accessToken}]}})})},n.prototype.render=function(){var e=this.state,n=e.currentUser,t=e.loading,a=this.props,i=a.platformId,r=a.children,o={platformId:i,currentUser:n,client:a.client,loading:t,login:this.login,logout:this.logout};return React__default.createElement(Provider,{value:o},r)},n}(React.Component),NoStackProvider=function(e){var n=e.client,t=e.platformId,a=e.children;return React__default.createElement(reactCommon.ApolloProvider,{client:n},React__default.createElement(reactComponents.Mutation,{mutation:EXECUTE_ACTION},function(e){return React__default.createElement(RawNoStackProvider,{client:n,platformId:t,loginUser:e},a)}))};function withNoStack(e){return function(n){return React__default.createElement(NoStackConsumer,null,function(t){return React__default.createElement(e,__assign({},t,n))})}}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var classCallCheck=_classCallCheck;function _defineProperties(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}var createClass=_createClass;function createCommonjsModule(e,n){return e(n={exports:{}},n.exports),n.exports}var _typeof_1=createCommonjsModule(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(a){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=t=function(e){return n(e)}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},t(a)}e.exports=t});function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var assertThisInitialized=_assertThisInitialized;function _possibleConstructorReturn(e,n){return!n||"object"!==_typeof_1(n)&&"function"!=typeof n?assertThisInitialized(e):n}var possibleConstructorReturn=_possibleConstructorReturn,getPrototypeOf=createCommonjsModule(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n}),setPrototypeOf=createCommonjsModule(function(e){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},n(t,a)}e.exports=n});function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&setPrototypeOf(e,n)}var inherits=_inherits;function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var defineProperty=_defineProperty;function _taggedTemplateLiteral(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var taggedTemplateLiteral=_taggedTemplateLiteral;function treeToGraph(e,n,t,a){var i=a.reduce(function(e,n){return Object.assign(defineProperty({},n.type.id,n.order.toString()),e)},{}),r=n.map(function(e){return e.id}),o=(e.nodes&&e.nodes.length>0?e.nodes.reduce(function(e,n){return e.find(function(e){return e.id===n.id})?e:e.concat([n])},[]):[e.root]).map(function(e){var n=e.name+(Object.prototype.hasOwnProperty.call(i,e.id)?" *(".concat(i[e.id],")*"):""),t=r.indexOf(e.id)>-1?"returnedTypes":"";return{id:e.id,label:n,group:t}}),d=e.assns.map(function(e){return{from:e.types[0].id,to:e.types[1].id}}),l=t.map(function(e){return{id:e.id,label:e.value,group:"constraints"}}),s=t.map(function(e){return{from:e.id,to:e.type.id}});return{nodes:o.concat(l),edges:d.concat(s)}}var templateObject_1,options={layout:{hierarchical:!1},height:"400px",nodes:{font:{size:25,multi:"markdown",color:"#6c6c6c",bold:{color:"#f51717",mod:""}},shape:"box"},edges:{arrows:{to:{enabled:!1},middle:{enabled:!1},from:{enabled:!1}}},groups:{constraints:{title:"constraint",font:{size:20,color:"#ffffff"},color:{background:"#f55b5b",border:"#f51717",highlight:"#f51717"},physics:!1},returnedTypes:{title:"returned types",font:{color:"#000000"}}}},SourceTypeTree=function(e){var n=e.source,t=n.tree,a=n.types,i=n.constraints,r=n.sortings;if(!t)return null;var o=treeToGraph(t,a,i,r);return React__default.createElement(Graph,{graph:o,options:options})},Select=styled.select(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  background: transparent;\n  border: none;\n  font-size: 14px;\n  height: 29px;\n  width: 268px;\n  padding: 5px;\n  margin-left: 10px;\n  background: url(https://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/16x16/br_down.png)\n    no-repeat right #ddd;\n  background-position-x: 244px;\n  background-color: #3b8ec2;\n  border-radius: 5px;\n  appearance: none;\n"],["\n  background: transparent;\n  border: none;\n  font-size: 14px;\n  height: 29px;\n  width: 268px;\n  padding: 5px;\n  margin-left: 10px;\n  background: url(https://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/16x16/br_down.png)\n    no-repeat right #ddd;\n  background-position-x: 244px;\n  background-color: #3b8ec2;\n  border-radius: 5px;\n  appearance: none;\n"]))),Dropdown=function(e){var n=e.options,t=void 0===n?[]:n,a=e.onSelect,i=e.disabled,r=void 0!==i&&i;return React__default.createElement(Select,{onChange:a,disabled:r},React__default.createElement("option",{value:void 0}),t.map(function(e){return React__default.createElement("option",{key:e.id,value:e.id},e.name)}))};function _objectWithoutPropertiesLoose(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}var objectWithoutPropertiesLoose=_objectWithoutPropertiesLoose;function _objectWithoutProperties(e,n){if(null==e)return{};var t,a,i=objectWithoutPropertiesLoose(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var objectWithoutProperties=_objectWithoutProperties,runtime_1=createCommonjsModule(function(e){var n=function(e){var n,t=Object.prototype,a=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",d=i.toStringTag||"@@toStringTag";function l(e,n,t,a){var i=n&&n.prototype instanceof f?n:f,r=Object.create(i.prototype),o=new C(a||[]);return r._invoke=function(e,n,t){var a=u;return function(i,r){if(a===m)throw new Error("Generator is already running");if(a===p){if("throw"===i)throw r;return R()}for(t.method=i,t.arg=r;;){var o=t.delegate;if(o){var d=b(o,t);if(d){if(d===v)continue;return d}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(a===u)throw a=p,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);a=m;var l=s(e,n,t);if("normal"===l.type){if(a=t.done?p:c,l.arg===v)continue;return{value:l.arg,done:t.done}}"throw"===l.type&&(a=p,t.method="throw",t.arg=l.arg)}}}(e,t,o),r}function s(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u="suspendedStart",c="suspendedYield",m="executing",p="completed",v={};function f(){}function k(){}function y(){}var N={};N[r]=function(){return this};var _=Object.getPrototypeOf,g=_&&_(_(A([])));g&&g!==t&&a.call(g,r)&&(N=g);var T=y.prototype=f.prototype=Object.create(N);function h(e){["next","throw","return"].forEach(function(n){e[n]=function(e){return this._invoke(n,e)}})}function S(e){var n;this._invoke=function(t,i){function r(){return new Promise(function(n,r){!function n(t,i,r,o){var d=s(e[t],e,i);if("throw"!==d.type){var l=d.arg,u=l.value;return u&&"object"==typeof u&&a.call(u,"__await")?Promise.resolve(u.__await).then(function(e){n("next",e,r,o)},function(e){n("throw",e,r,o)}):Promise.resolve(u).then(function(e){l.value=e,r(l)},function(e){return n("throw",e,r,o)})}o(d.arg)}(t,i,n,r)})}return n=n?n.then(r,r):r()}}function b(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,b(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=s(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function E(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function I(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(a.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:n,done:!0}}return k.prototype=T.constructor=y,y.constructor=k,y[d]=k.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===k||"GeneratorFunction"===(n.displayName||n.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d in e||(e[d]="GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},h(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(n,t,a,i){var r=new S(l(n,t,a,i));return e.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},h(T),T[d]="Generator",T[r]=function(){return this},T.toString=function(){return"[object Generator]"},e.keys=function(e){var n=[];for(var t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(a,i){return d.type="throw",d.arg=e,t.next=a,i&&(t.method="next",t.arg=n),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],d=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),s=a.call(o,"finallyLoc");if(l&&s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=n&&n<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=n,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(o)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),I(t),v}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var a=t.completion;if("throw"===a.type){var i=a.arg;I(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:A(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),v}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}),regenerator=runtime_1;function asyncGeneratorStep(e,n,t,a,i,r,o){try{var d=e[r](o),l=d.value}catch(e){return void t(e)}d.done?n(l):Promise.resolve(l).then(a,i)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise(function(a,i){var r=e.apply(n,t);function o(e){asyncGeneratorStep(r,a,i,o,d,"next",e)}function d(e){asyncGeneratorStep(r,a,i,o,d,"throw",e)}o(void 0)})}}var asyncToGenerator=_asyncToGenerator;function _templateObject2(){var e=taggedTemplateLiteral(["\n  color: #cb1c1c;\n"]);return _templateObject2=function(){return e},e}function _templateObject(){var e=taggedTemplateLiteral(["\n  margin: 1.5em;\n  text-align: center;\n"]);return _templateObject=function(){return e},e}var RENAME_TYPE_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RENAME_TYPE_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"UpdateType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"newName"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:144,source:{body:"\n  mutation RENAME_TYPE_MUTATION($id: ID!, $newName: String!) {\n    result: UpdateType(id: $id, name: $newName) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Wrapper=styled.div(_templateObject()),MessageDiv=styled.div(_templateObject2()),RenameTypePanel=function(e){function n(e){var t;return classCallCheck(this,n),t=possibleConstructorReturn(this,getPrototypeOf(n).call(this,e)),defineProperty(assertThisInitialized(t),"handleChange",function(e){t.setState({currentName:e.target.value})}),defineProperty(assertThisInitialized(t),"updateTypeName",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.state.currentName,a=t.props,i=a.type,r=a.renameType,n){e.next=4;break}return e.abrupt("return");case 4:return t.setState({processing:!0}),e.next=7,r({variables:{id:i.id,newName:n}});case 7:t.setState({processing:!1});case 8:case"end":return e.stop()}},e)}))),defineProperty(assertThisInitialized(t),"handleKeyPress",function(e){13===e.charCode&&t.updateTypeName()}),defineProperty(assertThisInitialized(t),"handleBlur",function(){t.updateTypeName()}),t.state={currentName:e.type.name,processing:!1},t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.state,n=e.currentName,t=e.processing;return React__default.createElement(Wrapper,null,React__default.createElement("label",{htmlFor:"type-name"},"Type Name:"," ",React__default.createElement("input",{id:"type-name",type:"text",value:n,onChange:this.handleChange,onBlur:this.handleBlur,onKeyPress:this.handleKeyPress,disabled:t})),t&&React__default.createElement(MessageDiv,null,"Saving..."))}}]),n}(React.Component);RenameTypePanel.propTypes={type:PropTypes.shape({id:PropTypes.string,name:PropTypes.string}).isRequired,renameType:PropTypes.func.isRequired};var RenameTypePanel$1=reactHoc.graphql(RENAME_TYPE_MUTATION,{name:"renameType"})(RenameTypePanel);function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}var arrayWithoutHoles=_arrayWithoutHoles;function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var iterableToArray=_iterableToArray;function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var nonIterableSpread=_nonIterableSpread;function _toConsumableArray(e){return arrayWithoutHoles(e)||iterableToArray(e)||nonIterableSpread()}var toConsumableArray=_toConsumableArray,SORTING_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SortingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Sorting"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"order"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:99,source:{body:"\n  fragment SortingFragment on Sorting {\n    id\n    order\n    type {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},CONSTRAINT_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ConstraintFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Constraint"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:105,source:{body:"\n  fragment ConstraintFragment on Constraint {\n    id\n    value\n    type {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},TREE_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TreeFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tree"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:238,source:{body:"\n  fragment TreeFragment on Tree {\n    id\n    name\n    root {\n      id\n      name\n    }\n    assns {\n      id\n      name\n      types {\n        id\n      }\n    }\n    nodes {\n      id\n      name\n    }\n    root {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function _templateObject$1(){var e=taggedTemplateLiteral(["\n  margin: 1em 0;\n"]);return _templateObject$1=function(){return e},e}var Row=styled.div(_templateObject$1()),ADD_TYPE_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"typeName"},value:{kind:"Variable",name:{kind:"Name",value:"typeName"}}},{kind:"Argument",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnName"},value:{kind:"Variable",name:{kind:"Name",value:"assnName"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:424,source:{body:"\n  mutation ADD_TYPE(\n    $typeId: ID!\n    $typeName: String!\n    $parentId: ID!\n    $assnId: ID!\n    $assnName: String!\n    $treeId: ID!\n  ) {\n    AddType(\n      typeId: $typeId\n      typeName: $typeName\n      parentId: $parentId\n      assnId: $assnId\n      assnName: $assnName\n      treeId: $treeId\n    ) {\n      id\n      name\n      assns {\n        id\n        name\n        types {\n          id\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},NewTypeForm=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{typeName:"",assnName:"",isSubmitting:!1,createSuccess:!1,error:""}),defineProperty(assertThisInitialized(t),"handleChange",function(e){e.preventDefault(),t.setState(defineProperty({},e.target.name,e.target.value))}),defineProperty(assertThisInitialized(t),"handleSubmit",function(){var e=asyncToGenerator(regenerator.mark(function e(n){var a,i,r,o,d,l,s,u,c;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.state,i=a.typeName,r=a.assnName,o=t.props,d=o.addType,l=o.parentType,s=o.treeId,n.preventDefault(),i&&r){e.next=5;break}return e.abrupt("return");case 5:return t.setState({isSubmitting:!0}),u=uuid.v4(),c=uuid.v4(),e.prev=8,e.next=11,d({variables:{typeId:u,typeName:i,parentId:l.id,assnId:c,assnName:r,treeId:s},update:function(e){var n=e.readFragment({id:s,fragment:TREE_FRAGMENT}),t={id:c,name:r,types:[{id:u,__typename:"Type"},{id:l.id,__typename:"Type"}],__typename:"Assn"},a={id:u,name:i,__typename:"Type"};n.assns=[].concat(toConsumableArray(n.assns),[t]),n.nodes=[].concat(toConsumableArray(n.nodes),[a]),e.writeFragment({id:s,fragment:TREE_FRAGMENT,data:n})}});case 11:t.setState({createSuccess:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),t.setState({error:"Something went wrong. Try again."});case 17:return e.prev=17,t.setState({isSubmitting:!1}),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[8,14,17,20]])}));return function(n){return e.apply(this,arguments)}}()),defineProperty(assertThisInitialized(t),"renderInput",function(e,n,a,i){return React__default.createElement(Row,null,React__default.createElement("label",{htmlFor:e},React__default.createElement("div",null,n),React__default.createElement("div",null,React__default.createElement("input",{id:e,name:a,type:"text",value:i,onChange:t.handleChange}))))}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.state,n=e.typeName,t=e.assnName,a=e.isSubmitting,i=e.createSuccess,r=e.error,o=this.props.parentType;return i?"Successfully created type!":a?"Creating new type...":React__default.createElement("form",{onSubmit:this.handleSubmit},React__default.createElement("div",null,React__default.createElement("h3",null,"Add a New Type"),r&&React__default.createElement(Row,null,r),this.renderInput("type-name","Type Name","typeName",n),this.renderInput("assn-name","What do you want to call the relationship between this new type and ".concat(o.name,"?"),"assnName",t),React__default.createElement(Row,null,React__default.createElement("button",{type:"submit",disabled:!n||!t},"Add Type"))))}}]),n}(React.Component);NewTypeForm.propTypes={parentType:PropTypes.shape({id:PropTypes.string,name:PropTypes.string}).isRequired,treeId:PropTypes.string.isRequired,addType:PropTypes.func.isRequired};var NewTypeForm$1=reactHoc.graphql(ADD_TYPE_MUTATION,{name:"addType"})(NewTypeForm);function _objectSpread(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.forEach(function(n){defineProperty(e,n,t[n])})}return e}var objectSpread=_objectSpread,TYPES_NOT_IN_TREE_QUERY={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TYPES_NOT_IN_TREE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"typesNotInTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:154,source:{body:"\n  query TYPES_NOT_IN_TREE($treeId: ID!, $platformId: ID!) {\n    typesNotInTree(treeId: $treeId, platformId: $platformId) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},TYPE_ASSNS_QUERY={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TYPE_ASSNS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Type"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:171,source:{body:"\n  query TYPE_ASSNS($id: ID!) {\n    Type(id: $id) {\n      id\n      assns {\n        id\n        name\n        types {\n          id\n          name\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function _templateObject$2(){var e=taggedTemplateLiteral(["\n  margin: 1em 0;\n"]);return _templateObject$2=function(){return e},e}var _unique=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},Wrapper$1=styled.div(_templateObject$2()),ADD_TO_TREE_MUTATION={kind:"Document",definitions:_unique([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_TO_TREE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddToTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TreeFragment"},directives:[]}]}}]}}].concat(TREE_FRAGMENT.definitions)),loc:{start:0,end:140,source:{body:"\n  mutation ADD_TO_TREE($assnId: ID!, $treeId: ID!) {\n    AddToTree(assnId: $assnId, treeId: $treeId) {\n      ...TreeFragment\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},ADD_ASSN_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_ASSN"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"childTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnName"},value:{kind:"Variable",name:{kind:"Name",value:"assnName"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"childTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"childTypeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:324,source:{body:"\n  mutation ADD_ASSN(\n    $assnId: ID!\n    $assnName: String!\n    $parentTypeId: ID!\n    $childTypeId: ID!\n  ) {\n    AddAssn(\n      assnId: $assnId\n      assnName: $assnName\n      parentTypeId: $parentTypeId\n      childTypeId: $childTypeId\n    ) {\n      id\n      name\n      types {\n        id\n        name\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},CREATE_ASSN_ID="CREATE_ASSN_ID",CreateAssnForm=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{selectedAssnId:null,newAssnName:""}),defineProperty(assertThisInitialized(t),"handleAssnSelect",function(e){e.target.value?t.setState({selectedAssnId:e.target.value}):t.setState({selectedAssnId:null})}),defineProperty(assertThisInitialized(t),"handleInputChange",function(e){e.preventDefault(),t.setState({newAssnName:e.target.value})}),defineProperty(assertThisInitialized(t),"handleCreateNewAssn",function(){var e=asyncToGenerator(regenerator.mark(function e(n){var a,i,r,o,d,l,s,u,c,m;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.props,i=a.addToTree,r=a.addAssn,o=a.setSubmitting,d=a.onCreate,l=a.treeId,s=a.parentTypeId,u=a.childTypeId,c=t.state.newAssnName,o(!0),n.preventDefault(),m=uuid.v4(),e.prev=5,e.next=8,r({variables:{assnId:m,assnName:c,parentTypeId:s,childTypeId:u}});case 8:return e.next=10,i({variables:{assnId:m,treeId:l},update:function(e,n){var t=n.data.AddToTree;e.writeFragment({id:l,fragment:TREE_FRAGMENT,data:objectSpread({},t)})}});case 10:d(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:return e.prev=16,o(!1),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[5,13,16,19]])}));return function(n){return e.apply(this,arguments)}}()),defineProperty(assertThisInitialized(t),"handleUseExistingAssn",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r,o,d,l,s;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,a=n.addToTree,i=n.setSubmitting,r=n.onCreate,o=n.treeId,d=n.childTypeId,l=n.platformId,s=t.state.selectedAssnId,i(!0),e.prev=3,e.next=6,a({variables:{assnId:s,treeId:o},update:function(e,n){var t=n.data.AddToTree;e.writeFragment({id:o,fragment:TREE_FRAGMENT,data:objectSpread({},t)});var a=e.readQuery({query:TYPES_NOT_IN_TREE_QUERY,variables:{treeId:o,platformId:l}}).typesNotInTree;e.writeQuery({query:TYPES_NOT_IN_TREE_QUERY,variables:{treeId:o,platformId:l},data:{typesNotInTree:a.filter(function(e){return e.id!==d})}})}});case 6:r(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:return e.prev=12,i(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[3,9,12,15]])}))),defineProperty(assertThisInitialized(t),"renderAddTypeWithNewAssnForm",function(){var e=t.state.newAssnName,n=t.props.isSubmitting;return React__default.createElement(Wrapper$1,null,React__default.createElement("form",{onSubmit:t.handleCreateNewAssn},React__default.createElement("div",null,React__default.createElement("label",{htmlFor:CREATE_ASSN_ID},"Name the association:",React__default.createElement("input",{id:CREATE_ASSN_ID,type:"text",disabled:n,value:e,onChange:t.handleInputChange}))),React__default.createElement("div",{style:{margin:"1em 0"}},React__default.createElement("button",{type:"submit",disabled:n},"Add Type"))))}),defineProperty(assertThisInitialized(t),"renderAddTypeWithExistingAssnButton",function(){var e=t.props.isSubmitting;return React__default.createElement(Wrapper$1,null,React__default.createElement("button",{type:"button",disabled:e,onClick:t.handleUseExistingAssn},"Add Type"))}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.childTypeId,a=n.parentTypeId,i=this.state.selectedAssnId;return React__default.createElement(reactComponents.Query,{query:TYPE_ASSNS_QUERY,variables:{id:t}},function(n){var t=n.loading,r=n.error,o=n.data;if(t)return"Fetching associations...";if(r)return"Error: ".concat(r.graphQLErrors);var d=o.Type[0].assns.filter(function(e){return e.types.some(function(e){return e.id===a})});return d.unshift({id:CREATE_ASSN_ID,name:"Create/use a new association..."}),React__default.createElement(React__default.Fragment,null,"Select an association between the two types:",React__default.createElement(Dropdown,{options:d,onSelect:e.handleAssnSelect}),i&&(i===CREATE_ASSN_ID?e.renderAddTypeWithNewAssnForm():e.renderAddTypeWithExistingAssnButton()))})}}]),n}(React.Component);CreateAssnForm.propTypes={childTypeId:PropTypes.string.isRequired,parentTypeId:PropTypes.string.isRequired,treeId:PropTypes.string.isRequired,platformId:PropTypes.string.isRequired,isSubmitting:PropTypes.bool.isRequired,setSubmitting:PropTypes.func.isRequired,onCreate:PropTypes.func.isRequired,addToTree:PropTypes.func.isRequired,addAssn:PropTypes.func.isRequired};var AddExistingTypeForm=compose(reactHoc.graphql(ADD_TO_TREE_MUTATION,{name:"addToTree"}),reactHoc.graphql(ADD_ASSN_MUTATION,{name:"addAssn"}))(CreateAssnForm);function _templateObject2$1(){var e=taggedTemplateLiteral(["\n  margin: 1em 0;\n"]);return _templateObject2$1=function(){return e},e}function _templateObject$3(){var e=taggedTemplateLiteral(["\n  margin: 1em;\n"]);return _templateObject$3=function(){return e},e}var Wrapper$2=styled.div(_templateObject$3()),Row$1=styled.div(_templateObject2$1()),AddExistingTypePanel=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{selectedTypeId:null,isSubmitting:!1,createSuccess:!1}),defineProperty(assertThisInitialized(t),"handleTypeSelect",function(e){e.target.value?t.setState({selectedTypeId:e.target.value}):t.setState({selectedTypeId:null})}),defineProperty(assertThisInitialized(t),"setSubmitting",function(e){return t.setState({isSubmitting:e})}),defineProperty(assertThisInitialized(t),"setCreateSuccess",function(){return t.setState({createSuccess:!0})}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this,n=this.state,t=n.isSubmitting,a=n.createSuccess,i=n.selectedTypeId,r=this.props,o=r.treeId,d=r.platformId,l=r.parentTypeId;return a?"Successfully added type.":React__default.createElement(reactComponents.Query,{query:TYPES_NOT_IN_TREE_QUERY,variables:{treeId:o,platformId:d}},function(n){var a=n.loading,r=n.error,s=n.data;return a?React__default.createElement(Wrapper$2,null,"Retrieving types..."):r?React__default.createElement(Wrapper$2,null,"Error: ",r.graphQLErrors):React__default.createElement(Wrapper$2,null,React__default.createElement(Row$1,null,"Select a type to add:",React__default.createElement(Dropdown,{options:s.typesNotInTree,onSelect:e.handleTypeSelect,disabled:t})),i&&React__default.createElement(Row$1,null,React__default.createElement(AddExistingTypeForm,{childTypeId:i,parentTypeId:l,treeId:o,platformId:d,isSubmitting:t,setSubmitting:e.setSubmitting,onCreate:e.setCreateSuccess})))})}}]),n}(React.Component);AddExistingTypePanel.propTypes={parentTypeId:PropTypes.string.isRequired,treeId:PropTypes.string.isRequired,platformId:PropTypes.string.isRequired};var AddExistingTypePanel$1=withNoStack(AddExistingTypePanel);function _templateObject2$2(){var e=taggedTemplateLiteral(["\n  width: 60%;\n  padding: 1em;\n  margin: 1em 2em;\n  cursor: pointer;\n"]);return _templateObject2$2=function(){return e},e}function _templateObject$4(){var e=taggedTemplateLiteral(["\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: center;\n  margin: 2em 0;\n"]);return _templateObject$4=function(){return e},e}var Wrapper$3=styled.div(_templateObject$4()),Button=styled.button(_templateObject2$2()),AddTypePanelModes={ADD_NEW:"ADD_NEW",ADD_EXISTING:"ADD_EXISTING"},AddTypePanel=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{mode:null}),defineProperty(assertThisInitialized(t),"setMode",function(e){return t.setState({mode:e})}),defineProperty(assertThisInitialized(t),"renderButton",function(e,n){return React__default.createElement("div",null,React__default.createElement(Button,{type:"button",onClick:function(){return t.setMode(n)}},e))}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props,n=e.type,t=e.source,a=this.state.mode;return a===AddTypePanelModes.ADD_EXISTING?React__default.createElement(AddExistingTypePanel$1,{parentTypeId:n.id,treeId:t.tree.id}):a===AddTypePanelModes.ADD_NEW?React__default.createElement(NewTypeForm$1,{parentType:n,treeId:t.tree.id}):React__default.createElement(Wrapper$3,null,this.renderButton("Add an Existing Type",AddTypePanelModes.ADD_EXISTING),this.renderButton("Add a New Type",AddTypePanelModes.ADD_NEW))}}]),n}(React.Component);function _templateObject$5(){var e=taggedTemplateLiteral([""]);return _templateObject$5=function(){return e},e}AddTypePanel.propTypes={type:PropTypes.shape({id:PropTypes.string,name:PropTypes.string}).isRequired,source:PropTypes.shape({id:PropTypes.string,tree:PropTypes.shape({id:PropTypes.string,root:PropTypes.shape({id:PropTypes.string,name:PropTypes.string})})}).isRequired};var CREATE_CONSTRAINT_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_CONSTRAINT_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"constraintType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConstraintType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateConstraint"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"constrainttype"},value:{kind:"Variable",name:{kind:"Name",value:"constraintType"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddConstraintType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"constraintid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddConstraintSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"constraintid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"sourceId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:409,source:{body:"\n  mutation CREATE_CONSTRAINT_MUTATION(\n    $id: ID!\n    $value: String!\n    $constraintType: ConstraintType!\n    $typeId: ID!\n    $sourceId: ID!\n  ) {\n    CreateConstraint(id: $id, value: $value, constrainttype: $constraintType) {\n      id\n    }\n\n    AddConstraintType(constraintid: $id, typeid: $typeId) {\n      id\n    }\n\n    AddConstraintSource(constraintid: $id, sourceid: $sourceId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Wrapper$4=styled.div(_templateObject$5()),ConstraintPanel=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{value:"",constraintType:"ID",processing:!1}),defineProperty(assertThisInitialized(t),"handleValueFieldChange",function(e){t.setState({value:e.target.value})}),defineProperty(assertThisInitialized(t),"handleConstraintTypeSelect",function(e){t.setState({constraintType:e.target.value})}),defineProperty(assertThisInitialized(t),"handleSubmit",function(e){var n=t.props,a=n.type,i=n.source,r=n.createConstraint,o=t.state,d=o.value,l=o.constraintType;e.preventDefault(),t.setState({processing:!0}),console.log(a,i,r,d,l),t.setState({processing:!1})}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.state,n=e.value,t=e.processing;return React__default.createElement(Wrapper$4,null,React__default.createElement("form",{onSubmit:this.handleSubmit},React__default.createElement("div",null,React__default.createElement("label",{htmlFor:"constraint-value"},"Constraint Value:"," ",React__default.createElement("input",{id:"constraint-value",type:"text",value:n,onChange:this.handleValueFieldChange,disabled:t}))),React__default.createElement("div",null,"Constraint Type:"," ",React__default.createElement("select",{id:"constraint-type",onChange:this.handleConstraintTypeSelect},React__default.createElement("option",{value:"ID"},"ID"),React__default.createElement("option",{value:"VALUE"},"VALUE"))),React__default.createElement("div",null,React__default.createElement("button",{type:"submit"},"Add Constraint"))))}}]),n}(React.Component),ConstraintPanel$1=reactHoc.graphql(CREATE_CONSTRAINT_MUTATION,{name:"createConstraint"})(ConstraintPanel);function _templateObject$6(){var e=taggedTemplateLiteral(["\n  margin: 1.5em;\n  text-align: center;\n"]);return _templateObject$6=function(){return e},e}var Wrapper$5=styled.div(_templateObject$6()),CREATE_SORTING_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSortingType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sortingid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSortingSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sortingid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"sourceId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:318,source:{body:"\n  mutation CREATE_SORTING_MUTATION(\n    $id: ID!\n    $order: Int!\n    $typeId: ID!\n    $sourceId: ID!\n  ) {\n    CreateSorting(id: $id, order: $order) {\n      id\n    }\n\n    AddSortingType(sortingid: $id, typeid: $typeId) {\n      id\n    }\n\n    AddSortingSource(sortingid: $id, sourceid: $sourceId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},UPDATE_SORTING_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UpdateSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:125,source:{body:"\n  mutation UPDATE_SORTING_MUTATION($id: ID!, $order: Int!) {\n    UpdateSorting(id: $id, order: $order) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DELETE_SORTING_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:96,source:{body:"\n  mutation DELETE_SORTING_MUTATION($id: ID!) {\n    DeleteSorting(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function SortingPanel(){return React__default.createElement(Wrapper$5,null,"For Implementation")}var _ComponentSelector,SortingPanel$1=compose(reactHoc.graphql(CREATE_SORTING_MUTATION,{name:"createSorting"}),reactHoc.graphql(UPDATE_SORTING_MUTATION,{name:"updateSorting"}),reactHoc.graphql(DELETE_SORTING_MUTATION,{name:"deleteSorting"}))(SortingPanel);function RemoveTypePanel(e){var n=e.name;return React__default.createElement("div",null,n)}var panels={RENAME:"RENAME",ADD_NODE:"ADD_NODE",CONSTRAIN:"CONSTRAIN",SORT_BY:"SORT_BY",REMOVE_NODE:"REMOVE_NODE"},ComponentSelector=(defineProperty(_ComponentSelector={},panels.RENAME,RenameTypePanel$1),defineProperty(_ComponentSelector,panels.ADD_NODE,AddTypePanel),defineProperty(_ComponentSelector,panels.CONSTRAIN,ConstraintPanel$1),defineProperty(_ComponentSelector,panels.SORT_BY,SortingPanel$1),defineProperty(_ComponentSelector,panels.REMOVE_NODE,RemoveTypePanel),_ComponentSelector);function TypeConfigurationSelector(e){var n=e.panel,t=objectWithoutProperties(e,["panel"]);if(!n||!Object.prototype.hasOwnProperty.call(panels,n))return React__default.createElement("div",null,'Error: Invalid panel "',n,'" selected!');var a=ComponentSelector[n];return React__default.createElement(a,t)}function _templateObject5(){var e=taggedTemplateLiteral(["\n  padding: 0.5em;\n"]);return _templateObject5=function(){return e},e}function _templateObject4(){var e=taggedTemplateLiteral(["\n  margin: 0.3em;\n  text-align: center;\n"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=taggedTemplateLiteral(["\n  background-color: #ffffff;\n  padding: 0.5em;\n  margin: 1em;\n  border-radius: 0.5em;\n  min-height: 250px;\n"]);return _templateObject3=function(){return e},e}function _templateObject2$3(){var e=taggedTemplateLiteral(["\n  font-size: 1.5rem;\n  padding: 0.5em;\n  background-color: #ffffff;\n  border-radius: 5px;\n"]);return _templateObject2$3=function(){return e},e}function _templateObject$7(){var e=taggedTemplateLiteral(["\n  padding: 0.5em;\n"]);return _templateObject$7=function(){return e},e}TypeConfigurationSelector.propTypes={panel:PropTypes.oneOf(Object.values(panels)).isRequired};var Wrapper$6=styled.div(_templateObject$7()),Header=styled.h1(_templateObject2$3()),ContentDiv=styled.div(_templateObject3()),MenuDiv=styled.div(_templateObject4()),MenuButton=styled.button(_templateObject5()),TypeConfigurationArea=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{selectedPanel:null}),defineProperty(assertThisInitialized(t),"handleButtonClick",function(e){return t.setState({selectedPanel:e.target.value})}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props,n=e.type,t=e.source,a=this.state.selectedPanel;return React__default.createElement(Wrapper$6,null,React__default.createElement(Header,null,"Configuring ",n.name),React__default.createElement(MenuDiv,null,React__default.createElement(MenuButton,{type:"button",value:panels.RENAME,onClick:this.handleButtonClick},"Rename"),React__default.createElement(MenuButton,{type:"button",value:panels.ADD_NODE,onClick:this.handleButtonClick},"Add Associated Type"),React__default.createElement(MenuButton,{type:"button",value:panels.CONSTRAIN,onClick:this.handleButtonClick},"Constrain"),React__default.createElement(MenuButton,{type:"button",value:panels.SORT_BY,onClick:this.handleButtonClick},"Sort By"),React__default.createElement(MenuButton,{type:"button",value:panels.REMOVE_NODE,onClick:this.handleButtonClick},"Remove")),a&&React__default.createElement(ContentDiv,null,React__default.createElement(TypeConfigurationSelector,{panel:a,type:n,source:t})))}}]),n}(React.Component),SourceControlPanel=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{selectedType:null}),defineProperty(assertThisInitialized(t),"getNodes",function(){var e=t.props.source.tree;return e.nodes&&e.nodes.length>0?e.nodes.reduce(function(e,n){return e.find(function(e){return e.id===n.id})?e:e.concat([n])},[]):[e.root]}),defineProperty(assertThisInitialized(t),"handleSelect",function(e){if(e.target.value){var n=t.getNodes().find(function(n){return n.id===e.target.value});t.setState({selectedType:n})}else t.setState({selectedType:null})}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props,n=e.source,t=e.ContentRow,a=this.state.selectedType,i=this.getNodes();return React__default.createElement("div",null,"Select a type to modify:",React__default.createElement(Dropdown,{options:i,onSelect:this.handleSelect}),a&&React__default.createElement(t,null,React__default.createElement(TypeConfigurationArea,{key:a.id,type:a,source:n})))}}]),n}(React.Component);function _templateObject3$1(){var e=taggedTemplateLiteral(["\n  padding: 10px;\n  margin: 10px;\n  border-radius: 3px;\n  background-color: #e6e0e0;\n"]);return _templateObject3$1=function(){return e},e}function _templateObject2$4(){var e=taggedTemplateLiteral(["\n  position: absolute;\n  left: 5px;\n  top: 0;\n  padding: 10px;\n  border-radius: 5px;\n  background-color: #fffdfd;\n  box-shadow: 5px 5px 20px #464646;\n  z-index: 999999;\n  min-width: 480px;\n"]);return _templateObject2$4=function(){return e},e}function _templateObject$8(){var e=taggedTemplateLiteral(["\n  position: relative;\n"]);return _templateObject$8=function(){return e},e}var Wrapper$7=styled.div(_templateObject$8()),SourceDiv=styled.div(_templateObject2$4()),ContentRow=styled.div(_templateObject3$1()),SourceInfoTree=function(e){var n=e.source;return n&&React__default.createElement(Wrapper$7,null,React__default.createElement(SourceDiv,null,React__default.createElement("div",null,"Source: ",n.name||"Unnamed Source"),React__default.createElement("div",null,"Source ID: ",n.id),React__default.createElement(ContentRow,null,React__default.createElement(SourceTypeTree,{source:n})),React__default.createElement(SourceControlPanel,{source:n,ContentRow:ContentRow})))},SOURCE_QUERY={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"SOURCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"Source"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"sortings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SortingFragment"},directives:[]}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"constraints"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConstraintFragment"},directives:[]}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"tree"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TreeFragment"},directives:[]}]}}]}}]}}].concat(SORTING_FRAGMENT.definitions,CONSTRAINT_FRAGMENT.definitions,TREE_FRAGMENT.definitions),loc:{start:0,end:291,source:{body:"\n  query SOURCE($id: ID!) {\n    Source(id: $id) {\n      id\n      name\n      sortings {\n        ...SortingFragment\n      }\n      types {\n        id\n        name\n      }\n      constraints {\n        ...ConstraintFragment\n      }\n      tree {\n        ...TreeFragment\n      }\n    }\n  }\n\n  \n  \n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function _templateObject2$5(){var e=taggedTemplateLiteral(["\n  direction: ltr;\n"]);return _templateObject2$5=function(){return e},e}function _templateObject$9(){var e=taggedTemplateLiteral(["\n  box-sizing: border-box;\n  background-color: white;\n  color: red;\n  font-size: 16px;\n  border: 1px dashed red;\n  width: 25px;\n  height: 25px;\n  padding: 0;\n  margin: 0;\n  text-align: center;\n  text-decoration: none;\n"]);return _templateObject$9=function(){return e},e}var Button$1=styled.button(_templateObject$9()),Wrapper$8=styled.div(_templateObject2$5()),SourceInfoButton=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{isTreeVisible:!1}),defineProperty(assertThisInitialized(t),"toggleTree",function(){return t.setState(function(e){return{isTreeVisible:!e.isTreeVisible}})}),defineProperty(assertThisInitialized(t),"setWrapperRef",function(e){t.wrapperRef=e}),defineProperty(assertThisInitialized(t),"handleClickOutside",function(e){t.state.isTreeVisible&&t.wrapperRef&&!t.wrapperRef.contains(e.target)&&t.setState({isTreeVisible:!1})}),t}return inherits(n,e),createClass(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this,n=this.props.id,t=this.state.isTreeVisible;return React__default.createElement(reactComponents.Query,{query:SOURCE_QUERY,variables:{id:n}},function(n){var a=n.loading,i=n.error,r=n.data;return a?null:i?"Error: ".concat(i.graphQLErrors):React__default.createElement(Wrapper$8,{ref:e.setWrapperRef},React__default.createElement(Button$1,{type:"button",onClick:e.toggleTree},t?"-":"+"),t&&React__default.createElement(SourceInfoTree,{source:r.Source[0]}))})}}]),n}(React.Component);SourceInfoButton.propTypes={id:PropTypes.string.isRequired};var templateObject_1$1,templateObject_2,templateObject_3,templateObject_4,Source=function(e){var n=e.id,t=e.query,a=e.typeRelationships,i=e.unrestricted,r=void 0!==i&&i,o=e.parameters,d=e.children,l={id:n,typeRelationships:JSON.stringify(a),unrestricted:r,parameters:JSON.stringify(o)},s=[{query:t,variables:l}],u=function(e){return function(n,a){var i;if(e)i=e;else{var r=a.data&&JSON.parse(a.data.ExecuteAction);i={instance:{id:r.instanceId,value:r.value,__typename:"Instance"},__typename:"InstanceWithChildren"}}var o=n.readQuery({query:t,variables:__assign({},l)}).sourceData;n.writeQuery({query:t,variables:__assign({},l),data:{sourceData:[i].concat(o)}})}},c=function(e,n){return function(t,a){var i=a.data&&JSON.parse(a.data.ExecuteAction);t.writeFragment({id:e,fragment:n,data:{id:e,value:i.value,__typename:"Instance"}})}},m=function(e){return function(n){var a=n.readQuery({query:t,variables:__assign({},l)}).sourceData;n.writeQuery({query:t,variables:__assign({},l),data:{sourceData:a.filter(function(n){return n.instance.id!==e})}})}};return React__default.createElement(NoStackConsumer,null,function(e){var a=e.currentUser;return React__default.createElement("div",null,a&&a.role&&"MODERATOR"===a.role&&React__default.createElement(SourceInfoButton,{id:n}),React__default.createElement(reactComponents.Query,{query:t,variables:l},function(e){var n=e.loading,t=e.error,a=e.data;return d(n?{loading:n,error:t,data:a}:t?{error:t}:{error:t,data:a,loading:n,queryVariables:l,refetchQueries:s,updateSourceAfterCreateAction:u,updateSourceAfterUpdateAction:c,updateSourceAfterDeleteAction:m})}))})},ConsoleWrapper=styled.div(templateObject_1$1||(templateObject_1$1=__makeTemplateObject(["\n  direction: ltr;\n  position: fixed;\n  left: 0;\n  top: 0;\n  z-index: 999999;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgb(0, 0, 0, 0.8);\n"],["\n  direction: ltr;\n  position: fixed;\n  left: 0;\n  top: 0;\n  z-index: 999999;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgb(0, 0, 0, 0.8);\n"]))),TextButton=styled.button(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  color: #007aff;\n  font-size: 0.9rem;\n  font-weight: 350;\n  background: none;\n  border: none;\n  margin: 0 0.5em;\n  padding: 0 0.2em;\n  cursor: pointer;\n\n  &:hover {\n    color: #ff6961;\n  }\n\n  &:disabled {\n    color: #dddddd;\n    cursor: default;\n  }\n\n  &::-moz-focus-inner {\n    border: 0;\n  }\n"],["\n  color: #007aff;\n  font-size: 0.9rem;\n  font-weight: 350;\n  background: none;\n  border: none;\n  margin: 0 0.5em;\n  padding: 0 0.2em;\n  cursor: pointer;\n\n  &:hover {\n    color: #ff6961;\n  }\n\n  &:disabled {\n    color: #dddddd;\n    cursor: default;\n  }\n\n  &::-moz-focus-inner {\n    border: 0;\n  }\n"]))),HighlightedForm=styled.div(templateObject_3||(templateObject_3=__makeTemplateObject(["\n  margin: 1em;\n  padding: 1em;\n  background-color: #f0ffff;\n"],["\n  margin: 1em;\n  padding: 1em;\n  background-color: #f0ffff;\n"]))),IdText=styled.span(templateObject_4||(templateObject_4=__makeTemplateObject(["\n  color: #c8c8c8;\n  font-size: 0.8em;\n  font-weight: 300;\n"],["\n  color: #c8c8c8;\n  font-size: 0.8em;\n  font-weight: 300;\n"]))),_extends_1=createCommonjsModule(function(e){function n(){return e.exports=n=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},n.apply(this,arguments)}e.exports=n}),ACTION_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ActionParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Action"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"actionType"},arguments:[],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:71,source:{body:"\n  fragment ActionParts on Action {\n    id\n    name\n    actionType\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},USER_CLASS_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"UserClassParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserClass"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"actions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ActionParts"},directives:[]}]}}]}}].concat(ACTION_FRAGMENT.definitions),loc:{start:0,end:107,source:{body:"\n  fragment UserClassParts on UserClass {\n    id\n    name\n    actions {\n      ...ActionParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},SOURCE_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SourceParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Source"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:56,source:{body:"\n  fragment SourceParts on Source {\n    id\n    name\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},COLLECTION_FRAGMENT={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CollectionParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Collection"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}}]}}].concat(SOURCE_FRAGMENT.definitions),loc:{start:0,end:109,source:{body:"\n  fragment CollectionParts on Collection {\n    id\n    name\n    sources {\n      ...SourceParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DELETE_ACTION_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:85,source:{body:"\n  mutation DELETE_ACTION($id: ID!) {\n    DeleteAction(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DeleteUserActionButton=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{showConfirmation:!1,showDeleting:!1}),defineProperty(assertThisInitialized(t),"showConfirmationDialog",function(){return t.setState({showConfirmation:!0})}),defineProperty(assertThisInitialized(t),"hideConfirmationDialog",function(){return t.setState({showConfirmation:!1})}),defineProperty(assertThisInitialized(t),"handleDelete",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,a=n.action,i=n.userClassId,r=n.deleteAction,t.hideConfirmationDialog(),t.setState({showDeleting:!0}),e.next=5,r({variables:{id:a.id},update:function(e){var n=e.readFragment({id:i,fragment:USER_CLASS_FRAGMENT,fragmentName:"UserClassParts"});n.actions=n.actions.filter(function(e){return e.id!==a.id}),e.writeFragment({id:i,fragment:USER_CLASS_FRAGMENT,fragmentName:"UserClassParts",data:objectSpread({},n)})}});case 5:t.setState({showDeleting:!1});case 6:case"end":return e.stop()}},e)}))),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.state,n=e.showDeleting,t=e.showConfirmation;return n?"Deleting action...":t?React__default.createElement(React__default.Fragment,null,"Are you sure?"," ",React__default.createElement(TextButton,{type:"button",onClick:this.hideConfirmationDialog},"No")," ",React__default.createElement(TextButton,{type:"button",onClick:this.handleDelete},"Yes")):React__default.createElement(TextButton,{type:"button",onClick:this.showConfirmationDialog},"Delete")}}]),n}(React.Component);DeleteUserActionButton.propTypes={action:PropTypes.shape({id:PropTypes.string,name:PropTypes.string,actionType:PropTypes.string}).isRequired,userClassId:PropTypes.string.isRequired,deleteAction:PropTypes.func.isRequired};var DeleteUserActionButton$1=reactHoc.graphql(DELETE_ACTION_MUTATION,{name:"deleteAction"})(DeleteUserActionButton);function _templateObject$a(){var e=taggedTemplateLiteral(["\n  margin-bottom: 0.8em;\n"]);return _templateObject$a=function(){return e},e}var Wrapper$9=styled.div(_templateObject$a()),Action=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{showMenu:!1}),defineProperty(assertThisInitialized(t),"handleMouseEnter",function(){return t.setState({showMenu:!0})}),defineProperty(assertThisInitialized(t),"handleMouseLeave",function(){return t.setState({showMenu:!1})}),defineProperty(assertThisInitialized(t),"handleDelete",function(){}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props,n=e.action,t=e.userClassId,a=this.state.showMenu;return React__default.createElement(Wrapper$9,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},React__default.createElement("div",null,n.name,a&&React__default.createElement(DeleteUserActionButton$1,{action:n,userClassId:t})),React__default.createElement("div",null,React__default.createElement(IdText,null,n.id)))}}]),n}(React.Component);Action.propTypes={action:PropTypes.shape({id:PropTypes.string,name:PropTypes.string,actionType:PropTypes.string}).isRequired,userClassId:PropTypes.string.isRequired};var _unique$1=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},PLATFORM_QUERY={kind:"Document",definitions:_unique$1([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PLATFORM_QUERY"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Platform"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"classes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserClassParts"},directives:[]}]}}]}}]}}].concat(USER_CLASS_FRAGMENT.definitions)),loc:{start:0,end:144,source:{body:"\n  query PLATFORM_QUERY($id: ID!) {\n    Platform(id: $id) {\n      id\n      name\n      classes {\n        ...UserClassParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DELETE_USER_CLASS_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_USER_CLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:92,source:{body:"\n  mutation DELETE_USER_CLASS($id: ID!) {\n    DeleteUserClass(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},DeleteUserClassButton=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{showConfirmation:!1,isDeleting:!1}),defineProperty(assertThisInitialized(t),"showConfirmation",function(){return t.setState({showConfirmation:!0})}),defineProperty(assertThisInitialized(t),"hideConfirmation",function(){return t.setState({showConfirmation:!1,isDeleting:!1})}),defineProperty(assertThisInitialized(t),"handleDeleteUserClass",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,a=n.userClassId,i=n.platformId,r=n.deleteUserClass,t.setState({isDeleting:!0}),e.next=4,r({variables:{id:a},update:function(e){var n=e.readQuery({query:PLATFORM_QUERY,variables:{id:i}}).Platform;n[0].classes=n[0].classes.filter(function(e){return e.id!==a}),e.writeQuery({query:PLATFORM_QUERY,variables:{id:i},data:{Platform:n}})}});case 4:t.hideConfirmation();case 5:case"end":return e.stop()}},e)}))),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props.disabled,n=this.state,t=n.showConfirmation,a=n.isDeleting;return t?React__default.createElement(React__default.Fragment,null,"Are you sure?"," ",React__default.createElement(TextButton,{type:"button",disabled:e||a,onClick:this.hideConfirmation},"No")," ",React__default.createElement(TextButton,{type:"button",disabled:e||a,onClick:this.handleDeleteUserClass},"Yes")):React__default.createElement(TextButton,{type:"button",disabled:e,onClick:this.showConfirmation},"Delete")}}]),n}(React.Component);DeleteUserClassButton.propTypes={userClassId:PropTypes.string.isRequired,platformId:PropTypes.string.isRequired,disabled:PropTypes.bool,deleteUserClass:PropTypes.func.isRequired},DeleteUserClassButton.defaultProps={disabled:!1};var DeleteUserClassButton$1=reactHoc.graphql(DELETE_USER_CLASS_MUTATION,{name:"deleteUserClass"})(DeleteUserClassButton);function _templateObject$b(){var e=taggedTemplateLiteral(["\n  margin-top: -0.8em;\n"]);return _templateObject$b=function(){return e},e}var _unique$2=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},IdDiv=styled.div(_templateObject$b()),UPDATE_USERCLASS_MUTATION={kind:"Document",definitions:_unique$2([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_USERCLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"userClass"},name:{kind:"Name",value:"UpdateUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserClassParts"},directives:[]}]}}]}}].concat(USER_CLASS_FRAGMENT.definitions)),loc:{start:0,end:150,source:{body:"\n  mutation UPDATE_USERCLASS($id: ID!, $name: String!) {\n    userClass: UpdateUserClass(id: $id, name: $name) {\n      ...UserClassParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},UserClass=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{showMenu:!1,showActions:!1,isEditMode:!1,isSaving:!1}),defineProperty(assertThisInitialized(t),"handleMouseEnter",function(){return t.setState({showMenu:!0})}),defineProperty(assertThisInitialized(t),"handleMouseLeave",function(){return t.setState({showMenu:!1})}),defineProperty(assertThisInitialized(t),"toggleActions",function(){return t.setState(function(e){return{showActions:!e.showActions}})}),defineProperty(assertThisInitialized(t),"handleSaveUserClass",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,a=n.userClass,i=n.updateUserClassName,r=t.state.userClassName){e.next=4;break}return e.abrupt("return",t.setState({userClassName:a.name}));case 4:return t.setState({isSaving:!0}),e.next=7,i({variables:{id:a.id,name:r}});case 7:return t.toggleEditMode(),e.abrupt("return",t.setState({isSaving:!1}));case 9:case"end":return e.stop()}},e)}))),defineProperty(assertThisInitialized(t),"toggleEditMode",function(){t.setState(function(e){return{isEditMode:!e.isEditMode}})}),defineProperty(assertThisInitialized(t),"handleInputChange",function(e){e.preventDefault(),t.setState({userClassName:e.target.value})}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props,n=e.userClass,t=e.platformId,a=e.showActionView,i=e.showSourceView,r=this.state,o=r.userClassName,d=r.showMenu,l=r.showActions,s=r.isEditMode,u=r.isSaving;return React__default.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},React__default.createElement("h4",null,s?React__default.createElement("input",{type:"text",value:o,disabled:u,onChange:this.handleInputChange}):o,s&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextButton,{type:"button",disabled:u,onClick:this.handleSaveUserClass},"Save"),React__default.createElement(TextButton,{type:"button",disabled:u,onClick:this.toggleEditMode},"Cancel")),d&&!s&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextButton,{type:"button",onClick:this.toggleEditMode},"Edit"),React__default.createElement(DeleteUserClassButton$1,{userClassId:n.id,platformId:t,disabled:u}),React__default.createElement(TextButton,{type:"button",onClick:this.toggleActions},l?"Hide Actions":"Show Actions"),React__default.createElement(TextButton,{type:"button",onClick:function(){return i(n.id)}},"Sources"))),React__default.createElement(IdDiv,null,React__default.createElement(IdText,null,n.id)),l&&React__default.createElement("div",null,React__default.createElement("h5",null,"Actions",React__default.createElement(TextButton,{type:"button",onClick:function(){return a(n.id)}},"Add")),React__default.createElement("ul",null,n.actions.map(function(e){return React__default.createElement("li",null,React__default.createElement(Action,{key:e.id,userClassId:n.id,action:e}))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return n.prevUserClassName===e.userClass.name?null:{userClassName:e.userClass.name,prevUserClassName:e.userClass.name}}}]),n}(React.Component);UserClass.propTypes={userClass:PropTypes.shape({id:PropTypes.string,name:PropTypes.string,actions:PropTypes.arrayOf(PropTypes.object)}).isRequired,platformId:PropTypes.string.isRequired,updateUserClassName:PropTypes.func.isRequired,showActionView:PropTypes.func.isRequired,showSourceView:PropTypes.func.isRequired};var UserClass$1=reactHoc.graphql(UPDATE_USERCLASS_MUTATION,{name:"updateUserClassName"})(UserClass),AddUserClassForm=function(e){var n=e.userClassName,t=e.onChange,a=e.onSubmit,i=e.onCancel;return React__default.createElement("form",{onSubmit:a},React__default.createElement(HighlightedForm,null,React__default.createElement("h4",null,"New User Class"),React__default.createElement("div",null,"User Class Name:"," ",React__default.createElement("input",{type:"text",placeholder:"name",onChange:t,value:n}),React__default.createElement(TextButton,{type:"submit"},"Create"),React__default.createElement(TextButton,{type:"button",onClick:i},"Cancel"))))};AddUserClassForm.propTypes={userClassName:PropTypes.string.isRequired,onChange:PropTypes.func.isRequired,onSubmit:PropTypes.func.isRequired,onCancel:PropTypes.func.isRequired};var _unique$3=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},ADD_USER_CLASS_MUTATION={kind:"Document",definitions:_unique$3([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_USER_CLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"newUser"},name:{kind:"Name",value:"CreateUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"actions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"AddCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"collectionId"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}},{kind:"Argument",name:{kind:"Name",value:"collectionName"},value:{kind:"Variable",name:{kind:"Name",value:"collectionName"}}},{kind:"Argument",name:{kind:"Name",value:"restricted"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddUserClassCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userclassid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"collectionid"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"collection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}}]}}]}}].concat(COLLECTION_FRAGMENT.definitions)),loc:{start:0,end:610,source:{body:"\n  mutation ADD_USER_CLASS(\n    $id: ID!\n    $name: String!\n    $platformId: ID!\n    $collectionId: ID!\n    $collectionName: String!\n  ) {\n    newUser: CreateUserClass(id: $id, name: $name, platformId: $platformId) {\n      id\n      name\n      actions {\n        id\n        name\n      }\n    }\n\n    AddCollection(\n      collectionId: $collectionId\n      collectionName: $collectionName\n      restricted: true\n    ) {\n      ...CollectionParts\n    }\n\n    AddUserClassCollection(userclassid: $id, collectionid: $collectionId) {\n      id\n      name\n      collection {\n        ...CollectionParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},UserClassView=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{isFormVisible:!1,newUserClassName:"",isSubmitting:!1}),defineProperty(assertThisInitialized(t),"showActionView",function(e){var n=t.props;(0,n.changeView)(n.views.USER_ACTION_VIEW,{userClassId:e})}),defineProperty(assertThisInitialized(t),"showSourceView",function(e){var n=t.props;(0,n.changeView)(n.views.USER_SOURCE_VIEW,{userClassId:e})}),defineProperty(assertThisInitialized(t),"showForm",function(){return t.setState({isFormVisible:!0,newUserClassName:""})}),defineProperty(assertThisInitialized(t),"hideForm",function(){return t.setState({isFormVisible:!1,isSubmitting:!1})}),defineProperty(assertThisInitialized(t),"handleFormChange",function(e){e.preventDefault(),t.setState({newUserClassName:e.target.value})}),defineProperty(assertThisInitialized(t),"handleCreateUserClass",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r,o,d,l;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,a=n.platformData,i=n.addUserClass,r=t.state.newUserClassName,o=uuid.v4(),d=uuid.v4(),l="".concat(r," collection"),t.setState({isSubmitting:!0}),e.next=8,i({variables:{id:o,name:r,platformId:a.id,collectionId:d,collectionName:l},update:function(e,n){var t=n.data.newUser,i=e.readQuery({query:PLATFORM_QUERY,variables:{id:a.id}}).Platform;i[0].classes.push(t),e.writeQuery({query:PLATFORM_QUERY,variables:{id:a.id},data:{Platform:i}})}});case 8:t.hideForm();case 9:case"end":return e.stop()}},e)}))),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this,n=this.props.platformData,t=this.state,a=t.newUserClassName,i=t.isFormVisible,r=t.isSubmitting;return React__default.createElement("div",null,React__default.createElement("h2",null,n.name," Platform ",React__default.createElement(IdText,null,n.id)),React__default.createElement("h3",null,"User Classes",!i&&React__default.createElement(TextButton,{type:"button",onClick:this.showForm},"Add")),r?"Creating new User Class...":i&&React__default.createElement(AddUserClassForm,{userClassName:a,onChange:this.handleFormChange,onSubmit:this.handleCreateUserClass,onCancel:this.hideForm}),React__default.createElement("ul",null,n.classes.map(function(t){return React__default.createElement("li",{key:t.id},React__default.createElement(UserClass$1,{userClass:t,platformId:n.id,showActionView:e.showActionView,showSourceView:e.showSourceView}))})))}}]),n}(React.Component);UserClassView.propTypes={platformData:PropTypes.shape({id:PropTypes.string,name:PropTypes.string,classes:PropTypes.array}).isRequired,changeView:PropTypes.func.isRequired,views:PropTypes.shape({USER_ACTION_VIEW:PropTypes.string,USER_SOURCE_VIEW:PropTypes.string}).isRequired,addUserClass:PropTypes.func.isRequired};var UserClassView$1=reactHoc.graphql(ADD_USER_CLASS_MUTATION,{name:"addUserClass"})(UserClassView);function _templateObject2$6(){var e=taggedTemplateLiteral(["\n  margin: 1.5em 0;\n  color: red;\n"]);return _templateObject2$6=function(){return e},e}function _templateObject$c(){var e=taggedTemplateLiteral(["\n  margin: 1.5em 0;\n"]);return _templateObject$c=function(){return e},e}var ACTION_TYPES=["UPLOAD","APPROVE_UPLOAD","CONTACT","INVITE","ACCEPT_INVITATION","FIRST_LOGIN","RESPOND","NOTIFY","FOLLOW","PAY","BUY","RENT","POST","REQUEST_NEW_PASSWORD","SET_PASSWORD","LOGIN","REFRESH_USER_TOKEN","VERIFY_USER_TOKEN","CREATE_INSTANCE_WITHOUT_PARENT","CREATE_PUBLIC_INSTANCE","CREATE_INSTANCE_ASSN"],FieldWrapper=styled.div(_templateObject$c()),ErrorWrapper=styled.div(_templateObject2$6()),NewActionForm=function(e){var n=e.errors,t=e.isSubmitting,a=e.onCancel;return React__default.createElement(formik.Form,null,React__default.createElement("h2",null,"New Action"),React__default.createElement(FieldWrapper,null,React__default.createElement("label",{htmlFor:"actionName"},"Name:"," ",React__default.createElement(formik.Field,{id:"actionName",name:"actionName",placeholder:"name",disabled:t,validate:function(e){return!e&&"Name required."}}))),React__default.createElement(ErrorWrapper,null,React__default.createElement(formik.ErrorMessage,{name:"actionName"})),React__default.createElement(FieldWrapper,null,React__default.createElement("label",{htmlFor:"type"},"Type:"," ",React__default.createElement(formik.Field,{id:"type",name:"type",component:"select",validate:function(e){return!e&&"Please select an Action Type."},disabled:t},React__default.createElement("option",null),ACTION_TYPES.map(function(e){return React__default.createElement("option",{key:e,value:e},e)})))),React__default.createElement(ErrorWrapper,null,React__default.createElement(formik.ErrorMessage,{name:"type"})),React__default.createElement(FieldWrapper,null,React__default.createElement("label",{htmlFor:"params"},"Params:"," ",React__default.createElement(formik.Field,{id:"params",name:"params",placeholder:"params",component:"textarea",rows:"10",style:{width:"80%"},disabled:t}))),React__default.createElement(ErrorWrapper,null,React__default.createElement(formik.ErrorMessage,{name:"params"})),n&&n.length>0&&n.map(function(e){return React__default.createElement(ErrorWrapper,{key:uuid.v4()},e)}),React__default.createElement(FieldWrapper,null,React__default.createElement("button",{type:"submit",disabled:t},t?"Creating Action...":"Create Action")," ",React__default.createElement("button",{type:"button",onClick:a,disabled:t},"Cancel")))};function _templateObject$d(){var e=taggedTemplateLiteral([""]);return _templateObject$d=function(){return e},e}NewActionForm.propTypes={errors:PropTypes.arrayOf(PropTypes.string),onCancel:PropTypes.func.isRequired,isSubmitting:PropTypes.bool.isRequired},NewActionForm.defaultProps={errors:[]};var _unique$4=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},CREATE_ACTION_MUTATION={kind:"Document",definitions:_unique$4([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userClassId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActionType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"newAction"},name:{kind:"Name",value:"CreateAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"userClassId"},value:{kind:"Variable",name:{kind:"Name",value:"userClassId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}},{kind:"Argument",name:{kind:"Name",value:"actionParameters"},value:{kind:"Variable",name:{kind:"Name",value:"actionParameters"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ActionParts"},directives:[]}]}}]}}].concat(ACTION_FRAGMENT.definitions)),loc:{start:0,end:327,source:{body:"\n  mutation CREATE_ACTION(\n    $name: String!\n    $userClassId: ID!\n    $actionType: ActionType!\n    $actionParameters: String\n  ) {\n    newAction: CreateAction(\n      name: $name\n      userClassId: $userClassId\n      actionType: $actionType\n      actionParameters: $actionParameters\n    ) {\n      ...ActionParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Wrapper$a=styled.div(_templateObject$d()),UserActionView=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{errors:[]}),defineProperty(assertThisInitialized(t),"handleSubmit",function(){var e=asyncToGenerator(regenerator.mark(function e(n,a){var i,r,o,d,l,s,u,c,m,p;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.setSubmitting,r=t.props,o=r.userClassId,d=r.createAction,l=r.returnToIndex,s=n.actionName,u=n.type,c=n.params,t.setState({errors:[]}),m=[],e.prev=5,e.next=8,d({variables:{name:s,userClassId:o,actionType:u,actionParameters:JSON.stringify(JSON.parse(c))},update:function(e,n){var t=n.data.newAction,a=e.readFragment({id:o,fragment:USER_CLASS_FRAGMENT,fragmentName:"UserClassParts"});a.actions=a.actions.concat(t),e.writeFragment({id:o,fragment:USER_CLASS_FRAGMENT,fragmentName:"UserClassParts",data:objectSpread({},a)})}});case 8:if(p=e.sent,p.data.newAction){e.next=12;break}throw new Error("Failed to create action.");case 12:e.next=19;break;case 14:e.prev=14,e.t0=e.catch(5),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&m.push(e.t0.graphQLErrors),e.t0.networkError&&e.t0.networkError.result&&e.t0.networkError.result.errors&&e.t0.networkError.result.errors.length&&m.push(e.t0.networkError.result.errors),e.t0.message&&m.push(e.t0.message);case 19:if(i(!1),!m.length){e.next=23;break}return t.setState({errors:m}),e.abrupt("return");case 23:l();case 24:case"end":return e.stop()}},e,null,[[5,14]])}));return function(n,t){return e.apply(this,arguments)}}()),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props.returnToIndex,n=this.state.errors;return React__default.createElement(Wrapper$a,null,React__default.createElement(formik.Formik,{initialValues:{actionName:"",type:"",params:""},onSubmit:this.handleSubmit,render:function(t){return React__default.createElement(NewActionForm,_extends_1({},t,{errors:n,onCancel:e}))}}))}}]),n}(React.Component);UserActionView.propTypes={returnToIndex:PropTypes.func.isRequired,userClassId:PropTypes.string.isRequired,createAction:PropTypes.func.isRequired};var UserActionView$1=reactHoc.graphql(CREATE_ACTION_MUTATION,{name:"createAction"})(UserActionView),AddSourceForm=function(e){var n=e.sourceName,t=e.onChange,a=e.onSubmit,i=e.onCancel,r=e.disabled;return React__default.createElement("form",null,React__default.createElement(HighlightedForm,null,React__default.createElement("h4",null,"New Source"),"Name:"," ",React__default.createElement("input",{type:"text",value:n,onChange:t,disabled:r}),React__default.createElement(TextButton,{type:"button",onClick:a,disabled:r},"Add"),React__default.createElement(TextButton,{type:"button",onClick:i,disabled:r},"Cancel")))};AddSourceForm.propTypes={sourceName:PropTypes.string.isRequired,onSubmit:PropTypes.func.isRequired,onChange:PropTypes.func.isRequired,onCancel:PropTypes.func.isRequired,disabled:PropTypes.bool.isRequired};var modes,CREATE_FIRST_TYPE_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_FIRST_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddRootType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeName"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:167,source:{body:"\n  mutation CREATE_FIRST_TYPE($id: ID!, $name: String!, $treeId: ID!) {\n    AddRootType(typeId: $id, typeName: $name, treeId: $treeId) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},CreateFirstTypeForm=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={typeName:"",isSubmitting:!1},n.handleInputChange=function(e){return n.setState({typeName:e.target.value})},n.handleSubmit=function(e){return __awaiter(n,void 0,void 0,function(){var n,t,a,i,r,o;return __generator(this,function(d){switch(d.label){case 0:if(n=this.props,t=n.treeId,a=n.createFirstType,i=this.state.typeName,e.preventDefault(),!i)return[2];this.setState({isSubmitting:!0}),r=uuid.v4(),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,a({variables:{id:r,name:i,treeId:t},update:function(e){var n=e.readFragment({id:t,fragment:TREE_FRAGMENT});n.root={id:r,typeName:i},e.writeFragment({id:t,fragment:TREE_FRAGMENT,data:n})}})];case 2:return d.sent(),[3,4];case 3:return o=d.sent(),console.log(o),[3,4];case 4:return this.setState({isSubmitting:!1}),[2]}})})},n}return __extends(n,e),n.prototype.render=function(){var e=this.state,n=e.typeName,t=e.isSubmitting;return React__default.createElement("div",null,React__default.createElement("h4",null,"Source has no types yet. Add a type first."),React__default.createElement("form",{onSubmit:this.handleSubmit},React__default.createElement("label",{htmlFor:"type-name"},"Type Name:",React__default.createElement("input",{id:"type-name",type:"text",value:n,onChange:this.handleInputChange,disabled:t,style:{margin:"0.5em"}})),React__default.createElement(TextButton,{type:"submit",disabled:!n||t},"Add Type")))},n}(React.Component),CreateFirstTypeForm$1=reactHoc.graphql(CREATE_FIRST_TYPE_MUTATION,{name:"createFirstType"})(CreateFirstTypeForm),ADD_FIRST_TYPE_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_FIRST_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddTreeRoot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"treeid"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}]}}],loc:{start:0,end:184,source:{body:"\n  mutation ADD_FIRST_TYPE($treeId: ID!, $typeId: ID!) {\n    AddTreeRoot(treeid: $treeId, typeid: $typeId) {\n      id\n      name\n      root {\n        id\n        name\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},AddExistingAsFirstType=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={selectedTypeId:null,isSubmitting:!1},n.handleSelect=function(e){n.setState({selectedTypeId:e.target.value})},n.handleCreateType=function(){return __awaiter(n,void 0,void 0,function(){var e,n,t,a;return __generator(this,function(i){switch(i.label){case 0:return e=this.state.selectedTypeId,n=this.props,t=n.addFirstType,a=n.treeId,this.setState({isSubmitting:!0}),[4,t({variables:{typeId:e,treeId:a}})];case 1:return i.sent(),this.setState({isSubmitting:!1}),[2]}})})},n}return __extends(n,e),n.prototype.render=function(){var e=this,n=this.state,t=n.selectedTypeId,a=n.isSubmitting,i=this.props,r=i.treeId,o=i.platformId;return React__default.createElement("div",null,React__default.createElement("h4",null,"Source has no types yet. Select a type to add."),React__default.createElement(reactComponents.Query,{query:TYPES_NOT_IN_TREE_QUERY,variables:{treeId:r,platformId:o}},function(n){var t=n.loading,i=n.error,r=n.data;return t?React__default.createElement(React__default.Fragment,null,"Fetching available types..."):i?React__default.createElement(React__default.Fragment,null,"Something went wrong. Cannot fetch types."):React__default.createElement(Dropdown,{options:r&&r.typesNotInTree,onSelect:e.handleSelect,disabled:a})}),React__default.createElement(TextButton,{type:"button",disabled:!t||a,onClick:this.handleCreateType},"Add Type"))},n}(React.Component),AddExistingAsFirstType$1=compose(withNoStack,reactHoc.graphql(ADD_FIRST_TYPE_MUTATION,{name:"addFirstType"}))(AddExistingAsFirstType),Wrapper$b=styled.div(templateObject_1$2||(templateObject_1$2=__makeTemplateObject(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"])));!function(e){e[e.CREATE_NEW=0]="CREATE_NEW",e[e.ADD_EXISTING=1]="ADD_EXISTING"}(modes||(modes={}));var templateObject_1$2,CreateFirstType=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={mode:null},n}return __extends(n,e),n.prototype.render=function(){var e=this,n=this.state.mode,t=this.props.treeId;return n===modes.CREATE_NEW?React__default.createElement(CreateFirstTypeForm$1,{treeId:t}):n===modes.ADD_EXISTING?React__default.createElement(AddExistingAsFirstType$1,{treeId:t}):React__default.createElement(Wrapper$b,null,React__default.createElement("h4",null,"Source has no types yet."),React__default.createElement("div",null,React__default.createElement(TextButton,{type:"button",onClick:function(){return e.setState({mode:modes.CREATE_NEW})}},"Create New"),React__default.createElement(TextButton,{type:"button",onClick:function(){return e.setState({mode:modes.ADD_EXISTING})}},"Add Existing")))},n}(React.Component);function _templateObject3$2(){var e=taggedTemplateLiteral(["\n  margin: 1em auto;\n  padding: 1em;\n  border-radius: 3px;\n  background-color: #e6e0e0;\n  text-align: center;\n"]);return _templateObject3$2=function(){return e},e}function _templateObject2$7(){var e=taggedTemplateLiteral(["\n  margin-bottom: 0.2em;\n"]);return _templateObject2$7=function(){return e},e}function _templateObject$e(){var e=taggedTemplateLiteral(["\n  margin-bottom: 0.8em;\n"]);return _templateObject$e=function(){return e},e}var Wrapper$c=styled.div(_templateObject$e()),Header$1=styled.h4(_templateObject2$7()),Row$2=styled.div(_templateObject3$2()),UPDATE_SOURCE_NAME_MUTATION={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_SOURCE_NAME"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UpdateSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:130,source:{body:"\n  mutation UPDATE_SOURCE_NAME($id: ID!, $name: String!) {\n    UpdateSource(id: $id, name: $name) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Source$1=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{showMenu:!1,showControlPanel:!1,isEditMode:!1,isSaving:!1}),defineProperty(assertThisInitialized(t),"handleMouseEnter",function(){return t.setState({showMenu:!0})}),defineProperty(assertThisInitialized(t),"handleMouseLeave",function(){return t.setState({showMenu:!1})}),defineProperty(assertThisInitialized(t),"toggleControlPanel",function(){return t.setState(function(e){return{showControlPanel:!e.showControlPanel}})}),defineProperty(assertThisInitialized(t),"toggleEditMode",asyncToGenerator(regenerator.mark(function e(){return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.setState(function(e){return{isEditMode:!e.isEditMode}});case 1:case"end":return e.stop()}},e)}))),defineProperty(assertThisInitialized(t),"handleInputChange",function(e){e.preventDefault(),t.setState({sourceName:e.target.value})}),defineProperty(assertThisInitialized(t),"handleSaveSourceName",asyncToGenerator(regenerator.mark(function e(){var n,a,i,r;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,a=n.source,i=n.updateSourceName,r=t.state.sourceName){e.next=4;break}return e.abrupt("return",t.setState({sourceName:a.name}));case 4:return t.setState({isSaving:!0}),e.next=7,i({variables:{id:a.id,name:r}});case 7:return t.toggleEditMode(),e.abrupt("return",t.setState({isSaving:!1}));case 9:case"end":return e.stop()}},e)}))),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.props.source,n=this.state,t=n.sourceName,a=n.isEditMode,i=n.showMenu,r=n.showControlPanel,o=n.isSaving;return React__default.createElement(Wrapper$c,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},React__default.createElement(Header$1,null,a?React__default.createElement("input",{type:"text",value:t,disabled:o,onChange:this.handleInputChange}):t,a&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextButton,{type:"button",disabled:o,onClick:this.handleSaveSourceName},"Save"),React__default.createElement(TextButton,{type:"button",disabled:o,onClick:this.toggleEditMode},"Cancel")),i&&!a&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextButton,{type:"button",onClick:this.toggleEditMode},"Edit"),React__default.createElement(TextButton,{type:"button",onClick:this.toggleControlPanel},r?"Hide Control Panel":"Manage"))),React__default.createElement("div",null,React__default.createElement(IdText,null,e.id)),r&&React__default.createElement(reactComponents.Query,{query:SOURCE_QUERY,variables:{id:e.id}},function(e){var n=e.loading,t=e.error,a=e.data;if(n)return"Fetching Source info...";if(t)return"Error: ".concat(t.graphQLErrors);var i=a.Source[0],r=i.tree;return r?r.nodes&&Array.isArray(r.nodes)&&!(r.nodes.length<1)||r.root&&r.root.id?React__default.createElement("div",null,React__default.createElement(Row$2,null,React__default.createElement(SourceTypeTree,{source:i})),React__default.createElement(SourceControlPanel,{source:i,ContentRow:Row$2})):React__default.createElement(CreateFirstType,{treeId:r.id}):"Error retrieving tree."}))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return n.prevSourceName===e.source.name?null:{sourceName:e.source.name,prevSourceName:e.source.name}}}]),n}(React.Component);Source$1.propTypes={source:PropTypes.shape({id:PropTypes.string,name:PropTypes.string}).isRequired,updateSourceName:PropTypes.func.isRequired};var Source$2=reactHoc.graphql(UPDATE_SOURCE_NAME_MUTATION,{name:"updateSourceName"})(Source$1),_unique$5=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},USER_CLASS_COLLECTION_QUERY={kind:"Document",definitions:_unique$5([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"USER_CLASS_COLLECTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"collection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}}]}}]}}].concat(COLLECTION_FRAGMENT.definitions)),loc:{start:0,end:155,source:{body:"\n  query USER_CLASS_COLLECTION($id: ID) {\n    UserClass(id: $id) {\n      id\n      name\n      collection {\n        ...CollectionParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},CREATE_SOURCE_MUTATION={kind:"Document",definitions:_unique$5([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_SOURCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSourceCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"collectionid"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"CreateTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSourceTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"treeid"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}}]}}].concat(SOURCE_FRAGMENT.definitions)),loc:{start:0,end:405,source:{body:"\n  mutation CREATE_SOURCE(\n    $id: ID!\n    $name: String!\n    $collectionId: ID!\n    $treeId: ID!\n  ) {\n    CreateSource(id: $id, name: $name) {\n      ...SourceParts\n    }\n\n    AddSourceCollection(sourceid: $id, collectionid: $collectionId) {\n      ...SourceParts\n    }\n\n    CreateTree(id: $treeId) {\n      id\n    }\n\n    AddSourceTree(sourceid: $id, treeid: $treeId) {\n      ...SourceParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},UserSourceView=function(e){function n(){var e,t;classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(i))),defineProperty(assertThisInitialized(t),"state",{newSourceName:"",isFormVisible:!1,isSubmitting:!1}),defineProperty(assertThisInitialized(t),"showSourceForm",function(){return t.setState({isFormVisible:!0})}),defineProperty(assertThisInitialized(t),"hideSourceForm",function(){return t.setState({isFormVisible:!1})}),defineProperty(assertThisInitialized(t),"handleFormChange",function(e){e.preventDefault(),t.setState({newSourceName:e.target.value})}),defineProperty(assertThisInitialized(t),"handleCreateSource",function(e){return function(){var n=asyncToGenerator(regenerator.mark(function n(a){var i,r,o,d,l,s;return regenerator.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.state.newSourceName,r=t.props,o=r.createSource,d=r.userClassId,a.preventDefault(),l=uuid.v4(),s=uuid.v4(),t.setState({isSubmitting:!0}),n.next=8,o({variables:{id:l,name:i,collectionId:e,treeId:s},update:function(e){var n=e.readQuery({query:USER_CLASS_COLLECTION_QUERY,variables:{id:d}}).UserClass;n[0].collection[0].sources.push({id:l,name:i,__typename:"Source"}),e.writeQuery({query:USER_CLASS_COLLECTION_QUERY,variables:{id:d},data:{UserClass:n}})}});case 8:t.setState({isSubmitting:!1}),t.hideSourceForm();case 10:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}),t}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.userClassId,a=n.goBack,i=this.state,r=i.isFormVisible,o=i.isSubmitting,d=i.newSourceName;return React__default.createElement(reactComponents.Query,{query:USER_CLASS_COLLECTION_QUERY,variables:{id:t}},function(n){var i=n.loading,l=n.error,s=n.data;if(i)return"Loading...";if(l)return"Something went wrong.";var u=s.UserClass[0];if(!u.collection||u.collection.length<1)return React__default.createElement("div",{id:t},React__default.createElement(TextButton,{type:"button",onClick:a},"Back to User Class List"),React__default.createElement("h4",null,"Sorry, cannot read or add ",u.name,"'s Sources."));var c=u.collection[0];return React__default.createElement("div",{id:t},React__default.createElement(TextButton,{type:"button",onClick:a},"Back to User Class List"),React__default.createElement("h2",null,u.name," Sources",!r&&React__default.createElement(TextButton,{type:"button",onClick:e.showSourceForm},"Add")),r&&!o&&React__default.createElement(AddSourceForm,{sourceName:d,onChange:e.handleFormChange,onSubmit:e.handleCreateSource(c.id),disabled:o,onCancel:e.hideSourceForm}),o&&React__default.createElement("div",null,"Creating new Collection..."),React__default.createElement("ul",null,c.sources.length>0?c.sources.map(function(e){return React__default.createElement("li",{key:e.id},React__default.createElement(Source$2,{source:e}))}):React__default.createElement("li",null,"No sources yet.")))})}}]),n}(React.Component),UserSourceView$1=reactHoc.graphql(CREATE_SOURCE_MUTATION,{name:"createSource"})(UserSourceView),ViewSwitcher=function(e){function n(){var e,t,a;classCallCheck(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return a=possibleConstructorReturn(this,(e=getPrototypeOf(n)).call.apply(e,[this].concat(r))),defineProperty(assertThisInitialized(a),"views",{USER_CLASS_VIEW:"USER_CLASS_VIEW",USER_ACTION_VIEW:"USER_ACTION_VIEW",USER_SOURCE_VIEW:"USER_SOURCE_VIEW"}),defineProperty(assertThisInitialized(a),"ViewSelector",(defineProperty(t={},a.views.USER_CLASS_VIEW,UserClassView$1),defineProperty(t,a.views.USER_ACTION_VIEW,UserActionView$1),defineProperty(t,a.views.USER_SOURCE_VIEW,UserSourceView$1),t)),defineProperty(assertThisInitialized(a),"indexView",a.views.USER_CLASS_VIEW),defineProperty(assertThisInitialized(a),"indexProps",a.props),defineProperty(assertThisInitialized(a),"state",{currentView:a.views.USER_CLASS_VIEW,currentProps:a.props,history:[]}),defineProperty(assertThisInitialized(a),"changeView",function(e,n){var t=a.state,i=t.currentView,r=t.currentProps,o=t.history;a.setState({currentView:e,currentProps:n,history:[].concat(toConsumableArray(o),[{currentView:i,currentProps:r}])})}),defineProperty(assertThisInitialized(a),"goBack",function(){var e=a.state.history;if(!(e.length<1)){var n=toConsumableArray(e),t=n.pop(),i=t.currentView,r=t.currentProps;a.setState({currentView:i,currentProps:r,history:n})}}),defineProperty(assertThisInitialized(a),"returnToIndex",function(){a.setState({currentView:a.indexView,currentProps:a.props,history:[]})}),a}return inherits(n,e),createClass(n,[{key:"render",value:function(){var e=this.state,n=e.currentView,t=e.currentProps,a=this.ViewSelector[n];return React__default.createElement(a,_extends_1({},t,{changeView:this.changeView,goBack:this.goBack,returnToIndex:this.returnToIndex,views:this.views}))}}]),n}(React.Component);function _templateObject3$3(){var e=taggedTemplateLiteral(["\n  overflow: scroll;\n  flex: 1;\n  padding: 5px 10px;\n  border: 1px #eeeeee solid;\n"]);return _templateObject3$3=function(){return e},e}function _templateObject2$8(){var e=taggedTemplateLiteral(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  cursor: pointer;\n"]);return _templateObject2$8=function(){return e},e}function _templateObject$f(){var e=taggedTemplateLiteral(["\n  position: relative;\n  height: 90%;\n  width: 90%;\n  min-width: 640px;\n  max-width: 960px;\n  background-color: rgb(255, 255, 255, 1);\n  padding: 1em;\n  display: flex;\n  flex-direction: column;\n"]);return _templateObject$f=function(){return e},e}var Container=styled.div(_templateObject$f()),CloseButton=styled.button(_templateObject2$8()),Content=styled.div(_templateObject3$3()),Modal=function(e){function n(e){var t;return classCallCheck(this,n),t=possibleConstructorReturn(this,getPrototypeOf(n).call(this,e)),defineProperty(assertThisInitialized(t),"state",{}),defineProperty(assertThisInitialized(t),"handleClickOutside",function(e){var n=t.props.onHide;t.wrapperRef&&!t.wrapperRef.current.contains(e.target)&&n()}),t.wrapperRef=React__default.createRef(),t}return inherits(n,e),createClass(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var e=this.props,n=e.onHide,t=e.platformId;return React__default.createElement(ConsoleWrapper,null,React__default.createElement(Container,{ref:this.wrapperRef},React__default.createElement(CloseButton,{type:"button",onClick:function(){return n()}},"X"),React__default.createElement("h1",null,"no-stack console"),React__default.createElement(Content,null,React__default.createElement(reactComponents.Query,{query:PLATFORM_QUERY,variables:{id:t}},function(e){var n=e.loading,t=e.error,a=e.data;return n?"Loading...":t?"Something went wrong.":a&&a.Platform?React__default.createElement(ViewSwitcher,{platformData:a.Platform[0]}):"Failed to retrieve platform data."}))))}}]),n}(React.Component);Modal.propTypes={onHide:PropTypes.func,platformId:PropTypes.string.isRequired},Modal.defaultProps={onHide:function(){}};var Button$2=styled.button(templateObject_1$3||(templateObject_1$3=__makeTemplateObject(["\n  position: fixed;\n  z-index: 999999;\n  ",": 1em;\n  bottom: 1em;\n  opacity: 0.4;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n"],["\n  position: fixed;\n  z-index: 999999;\n  ",": 1em;\n  bottom: 1em;\n  opacity: 0.4;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n"])),function(e){return e.position});!function(e){e[e.left=0]="left",e[e.right=1]="right"}(exports.Position||(exports.Position={}));var templateObject_1$3,templateObject_1$4,templateObject_2$1,templateObject_1$5,Console=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={showConsole:!1},n.handleButtonClick=function(e){e.preventDefault(),n.setState({showConsole:!0})},n.handleHideConsole=function(){n.setState({showConsole:!1})},n}return __extends(n,e),n.prototype.render=function(){var e=this,n=this.state.showConsole,t=this.props.position;return React__default.createElement(NoStackConsumer,null,function(a){var i=a.currentUser,r=a.platformId;return i&&i.role&&"MODERATOR"===i.role?n?React__default.createElement(Modal,{platformId:r,onHide:e.handleHideConsole}):React__default.createElement(Button$2,{position:t,type:"button",onClick:e.handleButtonClick},"< >"):null})},n.defaultProps={position:"left"},n}(React.Component),Wrapper$d=styled.div(templateObject_1$4||(templateObject_1$4=__makeTemplateObject(["\n  max-width: 300px;\n  min-width: 200px;\n\n  padding: 1em 0;\n\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-radius: 10px 10px 10px 10px;\n  -moz-border-radius: 10px 10px 10px 10px;\n  -webkit-border-radius: 10px 10px 10px 10px;\n  -webkit-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  -moz-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n"],["\n  max-width: 300px;\n  min-width: 200px;\n\n  padding: 1em 0;\n\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-radius: 10px 10px 10px 10px;\n  -moz-border-radius: 10px 10px 10px 10px;\n  -webkit-border-radius: 10px 10px 10px 10px;\n  -webkit-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  -moz-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n"]))),Row$3=styled.div(templateObject_2$1||(templateObject_2$1=__makeTemplateObject(["\n  margin: 0.5em;\n  padding: 0.5em;\n  text-align: center;\n\n  input {\n    margin: 0 0.5em;\n  }\n"],["\n  margin: 0.5em;\n  padding: 0.5em;\n  text-align: center;\n\n  input {\n    margin: 0 0.5em;\n  }\n"]))),RawLoginForm=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={username:"",password:"",isSubmitting:!1,error:""},n.handleInputChange=function(e){var t;e.preventDefault(),n.setState(((t={})[e.currentTarget.name]=e.currentTarget.value,t))},n.handleSubmit=function(e){return __awaiter(n,void 0,void 0,function(){var n,t,a,i,r;return __generator(this,function(o){switch(o.label){case 0:n=this.state,t=n.username,a=n.password,i=this.props.login,e.preventDefault(),this.setState({isSubmitting:!0}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i({username:t,password:a})];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),this.setState({isSubmitting:!1,error:r.message||r.graphQLErrors}),[3,4];case 4:return[2]}})})},n}return __extends(n,e),n.prototype.render=function(){var e=this.props,n=e.loading,t=e.currentUser,a=e.submitButtonText,i=this.state,r=i.username,o=i.password,d=i.isSubmitting,l=i.error;return n||t?null:React__default.createElement(Wrapper$d,null,React__default.createElement("form",{onSubmit:this.handleSubmit},React__default.createElement(Row$3,null,React__default.createElement("label",{htmlFor:"nostack-username"},"Username:",React__default.createElement("input",{id:"nostack-username",type:"text",name:"username",disabled:d,value:r,onChange:this.handleInputChange}))),React__default.createElement(Row$3,null,React__default.createElement("label",{htmlFor:"nostack-password"},"Password:",React__default.createElement("input",{id:"nostack-password",type:"password",name:"password",disabled:d,value:o,onChange:this.handleInputChange}))),React__default.createElement(Row$3,null,React__default.createElement("button",{type:"submit",disabled:d||!r||!o},a)),l&&React__default.createElement(Row$3,null,l)))},n.defaultProps={currentUser:null,submitButtonText:"Log In"},n}(React.Component),LoginForm=withNoStack(RawLoginForm),Button$3=styled.button(templateObject_1$5||(templateObject_1$5=__makeTemplateObject(["\n  cursor: pointer;\n"],["\n  cursor: pointer;\n"]))),RawLogoutButton=function(e){var n=e.currentUser,t=void 0===n?null:n,a=e.logout,i=e.buttonText,r=void 0===i?"Log Out":i;return t&&React__default.createElement(Button$3,{type:"button",onClick:function(){return a()}},r)},LogoutButton=withNoStack(RawLogoutButton),AWS_CONFIG={region:"us-west-2",UserPoolId:"us-west-2_m5JX5p7P0",ClientId:"5uaag7pfc565c324v2r8om4tu1",identityPoolId:"us-west-2:415abfa9-619c-4ab5-aa20-c5b9ad1edbc0"},NO_STACK_URI="https://api.matchlynx.com/graphql",_this=void 0;function refreshToken(e){return __awaiter(this,void 0,void 0,function(){var n,t,a,i;return __generator(this,function(r){switch(r.label){case 0:if(!(n=localStorage.getItem("refreshToken")))return[2,null];t=JSON.stringify({refreshToken:n,platformId:e}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,axios({url:NO_STACK_URI,method:"post",data:{query:EXECUTE_ACTION,variables:{actionId:"96d3be63-53c5-418e-9167-71e3d43271e3",executionParameters:t,unrestricted:!0}}})];case 2:return(a=r.sent()).data&&a.data.ExecuteAction&&((i=JSON.parse(a.data.ExecuteAction)).id&&i.AuthenticationResult&&i.AuthenticationResult.AccessToken)?(localStorage.setItem("accessToken",i.AuthenticationResult.AccessToken),[2,i.AuthenticationResult.AccessToken]):[2,null];case 3:return r.sent(),[2,null];case 4:return[2]}})})}var createAuthLink=function(e){return apolloLinkContext.setContext(function(n,t){var a=t.headers;return __awaiter(_this,void 0,void 0,function(){var n,t;return __generator(this,function(i){switch(i.label){case 0:return(n=localStorage.getItem("accessToken"))&&(t=jwt.decode(n,{complete:!0}))?Math.ceil(Date.now()/1e3)>=t.payload.exp?[4,refreshToken(e)]:[3,2]:[2,{headers:a}];case 1:if(!(n=i.sent()))return localStorage.clear(),[2,{headers:a}];i.label=2;case 2:return[2,{headers:__assign({},a,{jwt:n})}]}})})})},httpLink=new apolloLinkHttp.HttpLink({uri:NO_STACK_URI});exports.ASSOCIATE_INSTANCES=ASSOCIATE_INSTANCES,exports.AWS_CONFIG=AWS_CONFIG,exports.CREATE_INSTANCE=CREATE_INSTANCE,exports.Console=Console,exports.DELETE_INSTANCE=DELETE_INSTANCE,exports.EXECUTE_ACTION=EXECUTE_ACTION,exports.LoginForm=LoginForm,exports.LogoutButton=LogoutButton,exports.NO_STACK_URI=NO_STACK_URI,exports.NoStackConsumer=NoStackConsumer,exports.NoStackProvider=NoStackProvider,exports.REGISTER_USER=REGISTER_USER,exports.Source=Source,exports.UPDATE_INSTANCE=UPDATE_INSTANCE,exports.createAuthLink=createAuthLink,exports.httpLink=httpLink,exports.withNoStack=withNoStack;
