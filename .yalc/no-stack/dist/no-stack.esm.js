import e,{createContext as n,Component as t}from"react";import{Mutation as i,Query as a}from"@apollo/react-components";import{ApolloProvider as r}from"@apollo/react-common";import d from"prop-types";import o from"styled-components";import l from"react-graph-vis";import{graphql as s}from"@apollo/react-hoc";import{v4 as u}from"uuid";import c from"@shopify/react-compose";import{Form as m,Field as v,ErrorMessage as p,Formik as k}from"formik";import{setContext as f}from"apollo-link-context";import{HttpLink as N}from"apollo-link-http";import y from"axios";import g from"jsonwebtoken";var h=function(e,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};function b(e,n){function t(){this.constructor=e}h(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var S=function(){return(S=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)};function I(e,n,t,i){return new(t||(t=Promise))(function(a,r){function d(e){try{l(i.next(e))}catch(e){r(e)}}function o(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){e.done?a(e.value):new t(function(n){n(e.value)}).then(d,o)}l((i=i.apply(e,n||[])).next())})}function E(e,n){var t,i,a,r,d={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;d;)try{if(t=1,i&&(a=2&r[0]?i.return:r[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return d.label++,{value:r[1],done:!1};case 5:d.label++,i=r[1],r=[0];continue;case 7:r=d.ops.pop(),d.trys.pop();continue;default:if(!(a=(a=d.trys).length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){d=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){d.label=r[1];break}if(6===r[0]&&d.label<a[1]){d.label=a[1],a=r;break}if(a&&d.label<a[2]){d.label=a[2],d.ops.push(r);break}a[2]&&d.ops.pop(),d.trys.pop();continue}r=n.call(e,d)}catch(e){r=[6,e],i=0}finally{t=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}}function T(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e}var A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"EXECUTE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"executionParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"unrestricted"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"ExecuteAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"actionId"},value:{kind:"Variable",name:{kind:"Name",value:"actionId"}}},{kind:"Argument",name:{kind:"Name",value:"executionParameters"},value:{kind:"Variable",name:{kind:"Name",value:"executionParameters"}}},{kind:"Argument",name:{kind:"Name",value:"unrestricted"},value:{kind:"Variable",name:{kind:"Name",value:"unrestricted"}}}],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:250,source:{body:"\n  mutation EXECUTE_ACTION(\n    $actionId: ID!\n    $executionParameters: String\n    $unrestricted: Boolean\n  ) {\n    ExecuteAction(\n      actionId: $actionId\n      executionParameters: $executionParameters\n      unrestricted: $unrestricted\n    )\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceID"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"parentInstanceId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:353,source:{body:"\n  mutation CREATE_INSTANCE(\n    $id: ID!\n    $value: String\n    $typeId: ID!\n    $parentId: ID!\n    $parentTypeId: ID!\n    $treeId: ID!\n  ) {\n    AddInstance(\n      typeId: $typeId\n      instanceID: $id\n      value: $value\n      parentTypeId: $parentTypeId\n      parentInstanceId: $parentId\n      treeId: $treeId\n    ) {\n      id\n      value\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ASSOCIATE_INSTANCES"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"secondInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeAssnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"CreateInstanceAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:{kind:"Name",value:"addAssnToFirstInstance"},name:{kind:"Name",value:"AddInstanceInstanceAssns"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"firstInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:{kind:"Name",value:"addAssnToSecondInstance"},name:{kind:"Name",value:"AddInstanceInstanceAssns"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"secondInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddInstanceAssnAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"instanceassnid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceAssnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnid"},value:{kind:"Variable",name:{kind:"Name",value:"typeAssnId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:603,source:{body:"\n  mutation ASSOCIATE_INSTANCES(\n    $firstInstanceId: ID!\n    $secondInstanceId: ID!\n    $instanceAssnId: ID!\n    $typeAssnId: ID!\n  ) {\n    CreateInstanceAssn(id: $instanceAssnId) {\n      id\n    }\n\n    addAssnToFirstInstance: AddInstanceInstanceAssns(\n      instanceid: $firstInstanceId\n      instanceassnid: $instanceAssnId\n    ) {\n      id\n    }\n\n    addAssnToSecondInstance: AddInstanceInstanceAssns(\n      instanceid: $secondInstanceId\n      instanceassnid: $instanceAssnId\n    ) {\n      id\n    }\n\n    AddInstanceAssnAssn(instanceassnid: $instanceAssnId, assnid: $typeAssnId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"UpdateInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"order"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:174,source:{body:"\n  mutation UPDATE_INSTANCE($id: ID!, $value: String, $order: Float) {\n    UpdateInstance(id: $id, value: $value, order: $order) {\n      id\n      value\n      order\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_INSTANCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentInstanceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"RemoveInstance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"instanceID"},value:{kind:"Variable",name:{kind:"Name",value:"instanceId"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"parentInstanceId"},value:{kind:"Variable",name:{kind:"Name",value:"parentInstanceId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:320,source:{body:"\n  mutation DELETE_INSTANCE(\n    $typeId: ID!\n    $instanceId: ID!\n    $parentTypeId: ID!\n    $parentInstanceId: ID!\n    $treeId: ID!\n  ) {\n    RemoveInstance(\n      typeId: $typeId\n      instanceID: $instanceId\n      parentTypeId: $parentTypeId\n      parentInstanceId: $parentInstanceId\n      treeId: $treeId\n    )\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"REGISTER_USER"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userClass"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"username"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"lastName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"password"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"user"},name:{kind:"Name",value:"CreateUserOnPlatform"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}},{kind:"Argument",name:{kind:"Name",value:"userClass"},value:{kind:"Variable",name:{kind:"Name",value:"userClass"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"username"}}},{kind:"Argument",name:{kind:"Name",value:"firstName"},value:{kind:"Variable",name:{kind:"Name",value:"firstName"}}},{kind:"Argument",name:{kind:"Name",value:"lastName"},value:{kind:"Variable",name:{kind:"Name",value:"lastName"}}},{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}},{kind:"Argument",name:{kind:"Name",value:"password"},value:{kind:"Variable",name:{kind:"Name",value:"password"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:464,source:{body:"\n  mutation REGISTER_USER(\n    $id: ID!\n    $platformId: ID!\n    $userClass: ID!\n    $username: String!\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n    $password: String!\n  ) {\n    user: CreateUserOnPlatform(\n      id: $id\n      platformId: $platformId\n      userClass: $userClass\n      name: $username\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n      password: $password\n    ) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},x=n({platformId:null,currentUser:null,client:void 0,loading:!0,login:function(){},logout:function(){}}),O=x.Provider,R=x.Consumer,_=function(n){var t=n.children;return e.createElement(R,null,function(e){if(void 0===e)throw new Error("NoStackConsumer must be used within a NoStackProvider.");return t(e)})},$=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={currentUser:null,loading:!0},e.setUser=function(n,t,i,a){return e.setState({currentUser:{id:n,username:t,role:i,accessToken:a}})},e.logout=function(n){var t=e.props.client;localStorage.clear(),t.resetStore(),e.setState({currentUser:null},n)},e.login=function(n){var t=n.username,i=n.password;return I(e,void 0,void 0,function(){var e,n,a,r,d,o;return E(this,function(l){switch(l.label){case 0:return e=this.props,n=e.loginUser,a=e.platformId,r=JSON.stringify({userName:t,password:i,platformId:a}),[4,n({variables:{actionId:"a0d89c1f-c423-45e0-9339-c719dcbb7afe",executionParameters:r,unrestricted:!0}}).catch(function(e){return{error:e}})];case 1:if((d=l.sent()).error||!d.data||!d.data.ExecuteAction){if(d.error.networkError)throw d.error.networkError;if(d.error.graphQLErrors)throw d.error.graphQLErrors[0];throw new Error("Unknown error.")}if(!((o=JSON.parse(d.data.ExecuteAction)).id&&o.userId&&o.userName&&o.role&&o.AuthenticationResult&&o.AuthenticationResult.AccessToken&&o.AuthenticationResult.RefreshToken))throw new Error("Unknown error.");return this.setUser(o.userId,o.userName,o.role,o.AuthenticationResult.AccessToken),[4,localStorage.setItem("accessToken",o.AuthenticationResult.AccessToken)];case 2:return l.sent(),[4,localStorage.setItem("refreshToken",o.AuthenticationResult.RefreshToken)];case 3:return l.sent(),[2,o]}})})},e}return b(t,n),t.prototype.componentDidMount=function(){return I(this,void 0,void 0,function(){var e;return E(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,this.loginWithToken()];case 1:return e=n.sent(),[3,5];case 2:return n.sent(),[4,this.refreshToken()];case 3:return n.sent(),[4,this.loginWithToken()];case 4:return e=n.sent(),[3,5];case 5:return e&&this.setUser(e.id,e.username,e.role,e.accessToken),this.setState({loading:!1}),[2]}})})},t.prototype.refreshToken=function(){return I(this,void 0,void 0,function(){var e,n,t,i,a,r,d;return E(this,function(o){switch(o.label){case 0:return e=this.props,n=e.loginUser,t=e.platformId,(i=localStorage.getItem("refreshToken"))?(a=JSON.stringify({refreshToken:i,platformId:t}),[4,n({variables:{actionId:"96d3be63-53c5-418e-9167-71e3d43271e3",executionParameters:a,unrestricted:!0}}).catch(function(e){return{error:e}})]):[2,this.logout()];case 1:return!(r=o.sent()).error&&r.data&&r.data.ExecuteAction&&((d=JSON.parse(r.data.ExecuteAction)).id&&d.AuthenticationResult&&d.AuthenticationResult.AccessToken)?[4,localStorage.setItem("accessToken",d.AuthenticationResult.AccessToken)]:[2,this.logout()];case 2:return o.sent(),[2,d.AuthenticationResult.AccessToken]}})})},t.prototype.loginWithToken=function(){return I(this,void 0,void 0,function(){var e,n,t,i,a,r,d;return E(this,function(o){switch(o.label){case 0:return e=this.props,n=e.loginUser,t=e.platformId,[4,localStorage.getItem("accessToken")];case 1:return(i=o.sent())?(a=JSON.stringify({accessToken:i,platformId:t}),[4,n({variables:{actionId:"1279e113-d70f-4a95-9890-a5cebd344f3d",executionParameters:a,unrestricted:!0}}).catch(function(e){return{error:e}})]):[2,this.logout()];case 2:if((r=o.sent()).error||!r.data||!r.data.ExecuteAction)throw new Error("Expired/Invalid Token");if(!((d=JSON.parse(r.data.ExecuteAction)).id&&d.userId&&d.role&&d.accessToken))throw new Error("Expired/Invalid Token");return[2,{id:d.userId,role:d.role,username:d.userName,accessToken:d.accessToken}]}})})},t.prototype.render=function(){var n=this.state,t=n.currentUser,i=n.loading,a=this.props,r=a.platformId,d=a.children,o={platformId:r,currentUser:t,client:a.client,loading:i,login:this.login,logout:this.logout};return e.createElement(O,{value:o},d)},t}(t),U=function(n){var t=n.client,a=n.platformId,d=n.children;return e.createElement(r,{client:t},e.createElement(i,{mutation:A},function(n){return e.createElement($,{client:t,platformId:a,loginUser:n},d)}))};function P(n){return function(t){return e.createElement(_,null,function(i){return e.createElement(n,S({},i,t))})}}var L=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")};function q(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var M=function(e,n,t){return n&&q(e.prototype,n),t&&q(e,t),e};function Q(e,n){return e(n={exports:{}},n.exports),n.exports}var G=Q(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(i){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=t=function(e){return n(e)}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},t(i)}e.exports=t});var j=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var W=function(e,n){return!n||"object"!==G(n)&&"function"!=typeof n?j(e):n},B=Q(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n}),Y=Q(function(e){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},n(t,i)}e.exports=n});var z=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&Y(e,n)};var J=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e};var H=function(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))};var X,K={layout:{hierarchical:!1},height:"400px",nodes:{font:{size:25,multi:"markdown",color:"#6c6c6c",bold:{color:"#f51717",mod:""}},shape:"box"},edges:{arrows:{to:{enabled:!1},middle:{enabled:!1},from:{enabled:!1}}},groups:{constraints:{title:"constraint",font:{size:20,color:"#ffffff"},color:{background:"#f55b5b",border:"#f51717",highlight:"#f51717"},physics:!1},returnedTypes:{title:"returned types",font:{color:"#000000"}}}},Z=function(n){var t=n.source,i=t.tree,a=t.types,r=t.constraints,d=t.sortings;if(!i)return null;var o=function(e,n,t,i){var a=i.reduce(function(e,n){return Object.assign(J({},n.type.id,n.order.toString()),e)},{}),r=n.map(function(e){return e.id}),d=(e.nodes&&e.nodes.length>0?e.nodes.reduce(function(e,n){return e.find(function(e){return e.id===n.id})?e:e.concat([n])},[]):[e.root]).map(function(e){var n=e.name+(Object.prototype.hasOwnProperty.call(a,e.id)?" *(".concat(a[e.id],")*"):""),t=r.indexOf(e.id)>-1?"returnedTypes":"";return{id:e.id,label:n,group:t}}),o=e.assns.map(function(e){return{from:e.types[0].id,to:e.types[1].id}}),l=t.map(function(e){return{id:e.id,label:e.value,group:"constraints"}}),s=t.map(function(e){return{from:e.id,to:e.type.id}});return{nodes:d.concat(l),edges:o.concat(s)}}(i,a,r,d);return e.createElement(l,{graph:o,options:K})},ee=o.select(X||(X=T(["\n  background: transparent;\n  border: none;\n  font-size: 14px;\n  height: 29px;\n  width: 268px;\n  padding: 5px;\n  margin-left: 10px;\n  background: url(https://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/16x16/br_down.png)\n    no-repeat right #ddd;\n  background-position-x: 244px;\n  background-color: #3b8ec2;\n  border-radius: 5px;\n  appearance: none;\n"],["\n  background: transparent;\n  border: none;\n  font-size: 14px;\n  height: 29px;\n  width: 268px;\n  padding: 5px;\n  margin-left: 10px;\n  background: url(https://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/16x16/br_down.png)\n    no-repeat right #ddd;\n  background-position-x: 244px;\n  background-color: #3b8ec2;\n  border-radius: 5px;\n  appearance: none;\n"]))),ne=function(n){var t=n.options,i=void 0===t?[]:t,a=n.onSelect,r=n.disabled,d=void 0!==r&&r;return e.createElement(ee,{onChange:a,disabled:d},e.createElement("option",{value:void 0}),i.map(function(n){return e.createElement("option",{key:n.id,value:n.id},n.name)}))};var te=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a};var ie=function(e,n){if(null==e)return{};var t,i,a=te(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a},ae=Q(function(e){var n=function(e){var n,t=Object.prototype,i=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",d=a.asyncIterator||"@@asyncIterator",o=a.toStringTag||"@@toStringTag";function l(e,n,t,i){var a=n&&n.prototype instanceof k?n:k,r=Object.create(a.prototype),d=new D(i||[]);return r._invoke=function(e,n,t){var i=u;return function(a,r){if(i===m)throw new Error("Generator is already running");if(i===v){if("throw"===a)throw r;return w()}for(t.method=a,t.arg=r;;){var d=t.delegate;if(d){var o=E(d,t);if(o){if(o===p)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(i===u)throw i=v,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);i=m;var l=s(e,n,t);if("normal"===l.type){if(i=t.done?v:c,l.arg===p)continue;return{value:l.arg,done:t.done}}"throw"===l.type&&(i=v,t.method="throw",t.arg=l.arg)}}}(e,t,d),r}function s(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u="suspendedStart",c="suspendedYield",m="executing",v="completed",p={};function k(){}function f(){}function N(){}var y={};y[r]=function(){return this};var g=Object.getPrototypeOf,h=g&&g(g(C([])));h&&h!==t&&i.call(h,r)&&(y=h);var b=N.prototype=k.prototype=Object.create(y);function S(e){["next","throw","return"].forEach(function(n){e[n]=function(e){return this._invoke(n,e)}})}function I(e){var n;this._invoke=function(t,a){function r(){return new Promise(function(n,r){!function n(t,a,r,d){var o=s(e[t],e,a);if("throw"!==o.type){var l=o.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){n("next",e,r,d)},function(e){n("throw",e,r,d)}):Promise.resolve(u).then(function(e){l.value=e,r(l)},function(e){return n("throw",e,r,d)})}d(o.arg)}(t,a,n,r)})}return n=n?n.then(r,r):r()}}function E(e,t){var i=e.iterator[t.method];if(i===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,E(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var a=s(i,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var r=a.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function T(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function A(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,d=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return d.next=d}}return{next:w}}function w(){return{value:n,done:!0}}return f.prototype=b.constructor=N,N.constructor=f,N[o]=f.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===f||"GeneratorFunction"===(n.displayName||n.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,N):(e.__proto__=N,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},S(I.prototype),I.prototype[d]=function(){return this},e.AsyncIterator=I,e.async=function(n,t,i,a){var r=new I(l(n,t,i,a));return e.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},S(b),b[o]="Generator",b[r]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var n=[];for(var t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=C,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(i,a){return o.type="throw",o.arg=e,t.next=i,a&&(t.method="next",t.arg=n),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var d=this.tryEntries[r],o=d.completion;if("root"===d.tryLoc)return a("end");if(d.tryLoc<=this.prev){var l=i.call(d,"catchLoc"),s=i.call(d,"finallyLoc");if(l&&s){if(this.prev<d.catchLoc)return a(d.catchLoc,!0);if(this.prev<d.finallyLoc)return a(d.finallyLoc)}else if(l){if(this.prev<d.catchLoc)return a(d.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return a(d.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=n&&n<=r.finallyLoc&&(r=null);var d=r?r.completion:{};return d.type=e,d.arg=n,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(d)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),p},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),A(t),p}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var i=t.completion;if("throw"===i.type){var a=i.arg;A(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:C(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=n),p}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}});function re(e,n,t,i,a,r,d){try{var o=e[r](d),l=o.value}catch(e){return void t(e)}o.done?n(l):Promise.resolve(l).then(i,a)}var de=function(e){return function(){var n=this,t=arguments;return new Promise(function(i,a){var r=e.apply(n,t);function d(e){re(r,i,a,d,o,"next",e)}function o(e){re(r,i,a,d,o,"throw",e)}d(void 0)})}};function oe(){var e=H(["\n  color: #cb1c1c;\n"]);return oe=function(){return e},e}function le(){var e=H(["\n  margin: 1.5em;\n  text-align: center;\n"]);return le=function(){return e},e}var se=o.div(le()),ue=o.div(oe()),ce=function(n){function i(e){var n;return L(this,i),n=W(this,B(i).call(this,e)),J(j(n),"handleChange",function(e){n.setState({currentName:e.target.value})}),J(j(n),"updateTypeName",de(ae.mark(function e(){var t,i,a,r;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.currentName,i=n.props,a=i.type,r=i.renameType,t){e.next=4;break}return e.abrupt("return");case 4:return n.setState({processing:!0}),e.next=7,r({variables:{id:a.id,newName:t}});case 7:n.setState({processing:!1});case 8:case"end":return e.stop()}},e)}))),J(j(n),"handleKeyPress",function(e){13===e.charCode&&n.updateTypeName()}),J(j(n),"handleBlur",function(){n.updateTypeName()}),n.state={currentName:e.type.name,processing:!1},n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.state,t=n.currentName,i=n.processing;return e.createElement(se,null,e.createElement("label",{htmlFor:"type-name"},"Type Name:"," ",e.createElement("input",{id:"type-name",type:"text",value:t,onChange:this.handleChange,onBlur:this.handleBlur,onKeyPress:this.handleKeyPress,disabled:i})),i&&e.createElement(ue,null,"Saving..."))}}]),i}();ce.propTypes={type:d.shape({id:d.string,name:d.string}).isRequired,renameType:d.func.isRequired};var me=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RENAME_TYPE_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"UpdateType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"newName"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:144,source:{body:"\n  mutation RENAME_TYPE_MUTATION($id: ID!, $newName: String!) {\n    result: UpdateType(id: $id, name: $newName) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"renameType"})(ce);var ve=function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}};var pe=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var ke=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var fe=function(e){return ve(e)||pe(e)||ke()},Ne={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SortingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Sorting"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"order"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:99,source:{body:"\n  fragment SortingFragment on Sorting {\n    id\n    order\n    type {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},ye={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ConstraintFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Constraint"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:105,source:{body:"\n  fragment ConstraintFragment on Constraint {\n    id\n    value\n    type {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},ge={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TreeFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tree"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0}]}}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:238,source:{body:"\n  fragment TreeFragment on Tree {\n    id\n    name\n    root {\n      id\n      name\n    }\n    assns {\n      id\n      name\n      types {\n        id\n      }\n    }\n    nodes {\n      id\n      name\n    }\n    root {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function he(){var e=H(["\n  margin: 1em 0;\n"]);return he=function(){return e},e}var be=o.div(he()),Se=function(n){function i(){var n,t;L(this,i);for(var a=arguments.length,r=new Array(a),d=0;d<a;d++)r[d]=arguments[d];return t=W(this,(n=B(i)).call.apply(n,[this].concat(r))),J(j(t),"state",{typeName:"",assnName:"",isSubmitting:!1,createSuccess:!1,error:""}),J(j(t),"handleChange",function(e){e.preventDefault(),t.setState(J({},e.target.name,e.target.value))}),J(j(t),"handleSubmit",function(){var e=de(ae.mark(function e(n){var i,a,r,d,o,l,s,c,m;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.state,a=i.typeName,r=i.assnName,d=t.props,o=d.addType,l=d.parentType,s=d.treeId,n.preventDefault(),a&&r){e.next=5;break}return e.abrupt("return");case 5:return t.setState({isSubmitting:!0}),c=u(),m=u(),e.prev=8,e.next=11,o({variables:{typeId:c,typeName:a,parentId:l.id,assnId:m,assnName:r,treeId:s},update:function(e){var n=e.readFragment({id:s,fragment:ge}),t={id:m,name:r,types:[{id:c,__typename:"Type"},{id:l.id,__typename:"Type"}],__typename:"Assn"},i={id:c,name:a,__typename:"Type"};n.assns=[].concat(fe(n.assns),[t]),n.nodes=[].concat(fe(n.nodes),[i]),e.writeFragment({id:s,fragment:ge,data:n})}});case 11:t.setState({createSuccess:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),t.setState({error:"Something went wrong. Try again."});case 17:return e.prev=17,t.setState({isSubmitting:!1}),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[8,14,17,20]])}));return function(n){return e.apply(this,arguments)}}()),J(j(t),"renderInput",function(n,i,a,r){return e.createElement(be,null,e.createElement("label",{htmlFor:n},e.createElement("div",null,i),e.createElement("div",null,e.createElement("input",{id:n,name:a,type:"text",value:r,onChange:t.handleChange}))))}),t}return z(i,t),M(i,[{key:"render",value:function(){var n=this.state,t=n.typeName,i=n.assnName,a=n.isSubmitting,r=n.createSuccess,d=n.error,o=this.props.parentType;return r?"Successfully created type!":a?"Creating new type...":e.createElement("form",{onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement("h3",null,"Add a New Type"),d&&e.createElement(be,null,d),this.renderInput("type-name","Type Name","typeName",t),this.renderInput("assn-name","What do you want to call the relationship between this new type and ".concat(o.name,"?"),"assnName",i),e.createElement(be,null,e.createElement("button",{type:"submit",disabled:!t||!i},"Add Type"))))}}]),i}();Se.propTypes={parentType:d.shape({id:d.string,name:d.string}).isRequired,treeId:d.string.isRequired,addType:d.func.isRequired};var Ie=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}},{kind:"Argument",name:{kind:"Name",value:"typeName"},value:{kind:"Variable",name:{kind:"Name",value:"typeName"}}},{kind:"Argument",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnName"},value:{kind:"Variable",name:{kind:"Name",value:"assnName"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:424,source:{body:"\n  mutation ADD_TYPE(\n    $typeId: ID!\n    $typeName: String!\n    $parentId: ID!\n    $assnId: ID!\n    $assnName: String!\n    $treeId: ID!\n  ) {\n    AddType(\n      typeId: $typeId\n      typeName: $typeName\n      parentId: $parentId\n      assnId: $assnId\n      assnName: $assnName\n      treeId: $treeId\n    ) {\n      id\n      name\n      assns {\n        id\n        name\n        types {\n          id\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"addType"})(Se);var Ee=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.forEach(function(n){J(e,n,t[n])})}return e},Te={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TYPES_NOT_IN_TREE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"typesNotInTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:154,source:{body:"\n  query TYPES_NOT_IN_TREE($treeId: ID!, $platformId: ID!) {\n    typesNotInTree(treeId: $treeId, platformId: $platformId) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Ae={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TYPE_ASSNS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Type"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:171,source:{body:"\n  query TYPE_ASSNS($id: ID!) {\n    Type(id: $id) {\n      id\n      assns {\n        id\n        name\n        types {\n          id\n          name\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function De(){var e=H(["\n  margin: 1em 0;\n"]);return De=function(){return e},e}var Ce,we,Ve=o.div(De()),Fe={kind:"Document",definitions:(Ce=[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_TO_TREE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddToTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TreeFragment"},directives:[]}]}}]}}].concat(ge.definitions),we={},Ce.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!we[n]&&(we[n]=!0,!0)})),loc:{start:0,end:140,source:{body:"\n  mutation ADD_TO_TREE($assnId: ID!, $treeId: ID!) {\n    AddToTree(assnId: $assnId, treeId: $treeId) {\n      ...TreeFragment\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},xe="CREATE_ASSN_ID",Oe=function(n){function i(){var n,t;L(this,i);for(var a=arguments.length,r=new Array(a),d=0;d<a;d++)r[d]=arguments[d];return t=W(this,(n=B(i)).call.apply(n,[this].concat(r))),J(j(t),"state",{selectedAssnId:null,newAssnName:""}),J(j(t),"handleAssnSelect",function(e){e.target.value?t.setState({selectedAssnId:e.target.value}):t.setState({selectedAssnId:null})}),J(j(t),"handleInputChange",function(e){e.preventDefault(),t.setState({newAssnName:e.target.value})}),J(j(t),"handleCreateNewAssn",function(){var e=de(ae.mark(function e(n){var i,a,r,d,o,l,s,c,m,v;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.props,a=i.addToTree,r=i.addAssn,d=i.setSubmitting,o=i.onCreate,l=i.treeId,s=i.parentTypeId,c=i.childTypeId,m=t.state.newAssnName,d(!0),n.preventDefault(),v=u(),e.prev=5,e.next=8,r({variables:{assnId:v,assnName:m,parentTypeId:s,childTypeId:c}});case 8:return e.next=10,a({variables:{assnId:v,treeId:l},update:function(e,n){var t=n.data.AddToTree;e.writeFragment({id:l,fragment:ge,data:Ee({},t)})}});case 10:o(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:return e.prev=16,d(!1),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[5,13,16,19]])}));return function(n){return e.apply(this,arguments)}}()),J(j(t),"handleUseExistingAssn",de(ae.mark(function e(){var n,i,a,r,d,o,l,s;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,i=n.addToTree,a=n.setSubmitting,r=n.onCreate,d=n.treeId,o=n.childTypeId,l=n.platformId,s=t.state.selectedAssnId,a(!0),e.prev=3,e.next=6,i({variables:{assnId:s,treeId:d},update:function(e,n){var t=n.data.AddToTree;e.writeFragment({id:d,fragment:ge,data:Ee({},t)});var i=e.readQuery({query:Te,variables:{treeId:d,platformId:l}}).typesNotInTree;e.writeQuery({query:Te,variables:{treeId:d,platformId:l},data:{typesNotInTree:i.filter(function(e){return e.id!==o})}})}});case 6:r(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:return e.prev=12,a(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[3,9,12,15]])}))),J(j(t),"renderAddTypeWithNewAssnForm",function(){var n=t.state.newAssnName,i=t.props.isSubmitting;return e.createElement(Ve,null,e.createElement("form",{onSubmit:t.handleCreateNewAssn},e.createElement("div",null,e.createElement("label",{htmlFor:xe},"Name the association:",e.createElement("input",{id:xe,type:"text",disabled:i,value:n,onChange:t.handleInputChange}))),e.createElement("div",{style:{margin:"1em 0"}},e.createElement("button",{type:"submit",disabled:i},"Add Type"))))}),J(j(t),"renderAddTypeWithExistingAssnButton",function(){var n=t.props.isSubmitting;return e.createElement(Ve,null,e.createElement("button",{type:"button",disabled:n,onClick:t.handleUseExistingAssn},"Add Type"))}),t}return z(i,t),M(i,[{key:"render",value:function(){var n=this,t=this.props,i=t.childTypeId,r=t.parentTypeId,d=this.state.selectedAssnId;return e.createElement(a,{query:Ae,variables:{id:i}},function(t){var i=t.loading,a=t.error,o=t.data;if(i)return"Fetching associations...";if(a)return"Error: ".concat(a.graphQLErrors);var l=o.Type[0].assns.filter(function(e){return e.types.some(function(e){return e.id===r})});return l.unshift({id:xe,name:"Create/use a new association..."}),e.createElement(e.Fragment,null,"Select an association between the two types:",e.createElement(ne,{options:l,onSelect:n.handleAssnSelect}),d&&(d===xe?n.renderAddTypeWithNewAssnForm():n.renderAddTypeWithExistingAssnButton()))})}}]),i}();Oe.propTypes={childTypeId:d.string.isRequired,parentTypeId:d.string.isRequired,treeId:d.string.isRequired,platformId:d.string.isRequired,isSubmitting:d.bool.isRequired,setSubmitting:d.func.isRequired,onCreate:d.func.isRequired,addToTree:d.func.isRequired,addAssn:d.func.isRequired};var Re=c(s(Fe,{name:"addToTree"}),s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_ASSN"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assnName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"childTypeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AddAssn"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assnId"},value:{kind:"Variable",name:{kind:"Name",value:"assnId"}}},{kind:"Argument",name:{kind:"Name",value:"assnName"},value:{kind:"Variable",name:{kind:"Name",value:"assnName"}}},{kind:"Argument",name:{kind:"Name",value:"parentTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"parentTypeId"}}},{kind:"Argument",name:{kind:"Name",value:"childTypeId"},value:{kind:"Variable",name:{kind:"Name",value:"childTypeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:324,source:{body:"\n  mutation ADD_ASSN(\n    $assnId: ID!\n    $assnName: String!\n    $parentTypeId: ID!\n    $childTypeId: ID!\n  ) {\n    AddAssn(\n      assnId: $assnId\n      assnName: $assnName\n      parentTypeId: $parentTypeId\n      childTypeId: $childTypeId\n    ) {\n      id\n      name\n      types {\n        id\n        name\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"addAssn"}))(Oe);function _e(){var e=H(["\n  margin: 1em 0;\n"]);return _e=function(){return e},e}function $e(){var e=H(["\n  margin: 1em;\n"]);return $e=function(){return e},e}var Ue=o.div($e()),Pe=o.div(_e()),Le=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{selectedTypeId:null,isSubmitting:!1,createSuccess:!1}),J(j(n),"handleTypeSelect",function(e){e.target.value?n.setState({selectedTypeId:e.target.value}):n.setState({selectedTypeId:null})}),J(j(n),"setSubmitting",function(e){return n.setState({isSubmitting:e})}),J(j(n),"setCreateSuccess",function(){return n.setState({createSuccess:!0})}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this,t=this.state,i=t.isSubmitting,r=t.createSuccess,d=t.selectedTypeId,o=this.props,l=o.treeId,s=o.platformId,u=o.parentTypeId;return r?"Successfully added type.":e.createElement(a,{query:Te,variables:{treeId:l,platformId:s}},function(t){var a=t.loading,r=t.error,o=t.data;return a?e.createElement(Ue,null,"Retrieving types..."):r?e.createElement(Ue,null,"Error: ",r.graphQLErrors):e.createElement(Ue,null,e.createElement(Pe,null,"Select a type to add:",e.createElement(ne,{options:o.typesNotInTree,onSelect:n.handleTypeSelect,disabled:i})),d&&e.createElement(Pe,null,e.createElement(Re,{childTypeId:d,parentTypeId:u,treeId:l,platformId:s,isSubmitting:i,setSubmitting:n.setSubmitting,onCreate:n.setCreateSuccess})))})}}]),i}();Le.propTypes={parentTypeId:d.string.isRequired,treeId:d.string.isRequired,platformId:d.string.isRequired};var qe=P(Le);function Me(){var e=H(["\n  width: 60%;\n  padding: 1em;\n  margin: 1em 2em;\n  cursor: pointer;\n"]);return Me=function(){return e},e}function Qe(){var e=H(["\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: center;\n  margin: 2em 0;\n"]);return Qe=function(){return e},e}var Ge=o.div(Qe()),je=o.button(Me()),We="ADD_NEW",Be="ADD_EXISTING",Ye=function(n){function i(){var n,t;L(this,i);for(var a=arguments.length,r=new Array(a),d=0;d<a;d++)r[d]=arguments[d];return t=W(this,(n=B(i)).call.apply(n,[this].concat(r))),J(j(t),"state",{mode:null}),J(j(t),"setMode",function(e){return t.setState({mode:e})}),J(j(t),"renderButton",function(n,i){return e.createElement("div",null,e.createElement(je,{type:"button",onClick:function(){return t.setMode(i)}},n))}),t}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props,t=n.type,i=n.source,a=this.state.mode;return a===Be?e.createElement(qe,{parentTypeId:t.id,treeId:i.tree.id}):a===We?e.createElement(Ie,{parentType:t,treeId:i.tree.id}):e.createElement(Ge,null,this.renderButton("Add an Existing Type",Be),this.renderButton("Add a New Type",We))}}]),i}();function ze(){var e=H([""]);return ze=function(){return e},e}Ye.propTypes={type:d.shape({id:d.string,name:d.string}).isRequired,source:d.shape({id:d.string,tree:d.shape({id:d.string,root:d.shape({id:d.string,name:d.string})})}).isRequired};var Je=o.div(ze()),He=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{value:"",constraintType:"ID",processing:!1}),J(j(n),"handleValueFieldChange",function(e){n.setState({value:e.target.value})}),J(j(n),"handleConstraintTypeSelect",function(e){n.setState({constraintType:e.target.value})}),J(j(n),"handleSubmit",function(e){var t=n.props,i=t.type,a=t.source,r=t.createConstraint,d=n.state,o=d.value,l=d.constraintType;e.preventDefault(),n.setState({processing:!0}),console.log(i,a,r,o,l),n.setState({processing:!1})}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.state,t=n.value,i=n.processing;return e.createElement(Je,null,e.createElement("form",{onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement("label",{htmlFor:"constraint-value"},"Constraint Value:"," ",e.createElement("input",{id:"constraint-value",type:"text",value:t,onChange:this.handleValueFieldChange,disabled:i}))),e.createElement("div",null,"Constraint Type:"," ",e.createElement("select",{id:"constraint-type",onChange:this.handleConstraintTypeSelect},e.createElement("option",{value:"ID"},"ID"),e.createElement("option",{value:"VALUE"},"VALUE"))),e.createElement("div",null,e.createElement("button",{type:"submit"},"Add Constraint"))))}}]),i}(),Xe=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_CONSTRAINT_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"constraintType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConstraintType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateConstraint"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}},{kind:"Argument",name:{kind:"Name",value:"constrainttype"},value:{kind:"Variable",name:{kind:"Name",value:"constraintType"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddConstraintType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"constraintid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddConstraintSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"constraintid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"sourceId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:409,source:{body:"\n  mutation CREATE_CONSTRAINT_MUTATION(\n    $id: ID!\n    $value: String!\n    $constraintType: ConstraintType!\n    $typeId: ID!\n    $sourceId: ID!\n  ) {\n    CreateConstraint(id: $id, value: $value, constrainttype: $constraintType) {\n      id\n    }\n\n    AddConstraintType(constraintid: $id, typeid: $typeId) {\n      id\n    }\n\n    AddConstraintSource(constraintid: $id, sourceid: $sourceId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"createConstraint"})(He);function Ke(){var e=H(["\n  margin: 1.5em;\n  text-align: center;\n"]);return Ke=function(){return e},e}var Ze=o.div(Ke());var en,nn=c(s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sourceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSortingType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sortingid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSortingSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sortingid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"sourceId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:318,source:{body:"\n  mutation CREATE_SORTING_MUTATION(\n    $id: ID!\n    $order: Int!\n    $typeId: ID!\n    $sourceId: ID!\n  ) {\n    CreateSorting(id: $id, order: $order) {\n      id\n    }\n\n    AddSortingType(sortingid: $id, typeid: $typeId) {\n      id\n    }\n\n    AddSortingSource(sortingid: $id, sourceid: $sourceId) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"createSorting"}),s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"order"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UpdateSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"Variable",name:{kind:"Name",value:"order"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:125,source:{body:"\n  mutation UPDATE_SORTING_MUTATION($id: ID!, $order: Int!) {\n    UpdateSorting(id: $id, order: $order) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"updateSorting"}),s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_SORTING_MUTATION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteSorting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:96,source:{body:"\n  mutation DELETE_SORTING_MUTATION($id: ID!) {\n    DeleteSorting(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"deleteSorting"}))(function(){return e.createElement(Ze,null,"For Implementation")});var tn={RENAME:"RENAME",ADD_NODE:"ADD_NODE",CONSTRAIN:"CONSTRAIN",SORT_BY:"SORT_BY",REMOVE_NODE:"REMOVE_NODE"},an=(J(en={},tn.RENAME,me),J(en,tn.ADD_NODE,Ye),J(en,tn.CONSTRAIN,Xe),J(en,tn.SORT_BY,nn),J(en,tn.REMOVE_NODE,function(n){var t=n.name;return e.createElement("div",null,t)}),en);function rn(n){var t=n.panel,i=ie(n,["panel"]);if(!t||!Object.prototype.hasOwnProperty.call(tn,t))return e.createElement("div",null,'Error: Invalid panel "',t,'" selected!');var a=an[t];return e.createElement(a,i)}function dn(){var e=H(["\n  padding: 0.5em;\n"]);return dn=function(){return e},e}function on(){var e=H(["\n  margin: 0.3em;\n  text-align: center;\n"]);return on=function(){return e},e}function ln(){var e=H(["\n  background-color: #ffffff;\n  padding: 0.5em;\n  margin: 1em;\n  border-radius: 0.5em;\n  min-height: 250px;\n"]);return ln=function(){return e},e}function sn(){var e=H(["\n  font-size: 1.5rem;\n  padding: 0.5em;\n  background-color: #ffffff;\n  border-radius: 5px;\n"]);return sn=function(){return e},e}function un(){var e=H(["\n  padding: 0.5em;\n"]);return un=function(){return e},e}rn.propTypes={panel:d.oneOf(Object.values(tn)).isRequired};var cn=o.div(un()),mn=o.h1(sn()),vn=o.div(ln()),pn=o.div(on()),kn=o.button(dn()),fn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{selectedPanel:null}),J(j(n),"handleButtonClick",function(e){return n.setState({selectedPanel:e.target.value})}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props,t=n.type,i=n.source,a=this.state.selectedPanel;return e.createElement(cn,null,e.createElement(mn,null,"Configuring ",t.name),e.createElement(pn,null,e.createElement(kn,{type:"button",value:tn.RENAME,onClick:this.handleButtonClick},"Rename"),e.createElement(kn,{type:"button",value:tn.ADD_NODE,onClick:this.handleButtonClick},"Add Associated Type"),e.createElement(kn,{type:"button",value:tn.CONSTRAIN,onClick:this.handleButtonClick},"Constrain"),e.createElement(kn,{type:"button",value:tn.SORT_BY,onClick:this.handleButtonClick},"Sort By"),e.createElement(kn,{type:"button",value:tn.REMOVE_NODE,onClick:this.handleButtonClick},"Remove")),a&&e.createElement(vn,null,e.createElement(rn,{panel:a,type:t,source:i})))}}]),i}(),Nn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{selectedType:null}),J(j(n),"getNodes",function(){var e=n.props.source.tree;return e.nodes&&e.nodes.length>0?e.nodes.reduce(function(e,n){return e.find(function(e){return e.id===n.id})?e:e.concat([n])},[]):[e.root]}),J(j(n),"handleSelect",function(e){if(e.target.value){var t=n.getNodes().find(function(n){return n.id===e.target.value});n.setState({selectedType:t})}else n.setState({selectedType:null})}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props,t=n.source,i=n.ContentRow,a=this.state.selectedType,r=this.getNodes();return e.createElement("div",null,"Select a type to modify:",e.createElement(ne,{options:r,onSelect:this.handleSelect}),a&&e.createElement(i,null,e.createElement(fn,{key:a.id,type:a,source:t})))}}]),i}();function yn(){var e=H(["\n  padding: 10px;\n  margin: 10px;\n  border-radius: 3px;\n  background-color: #e6e0e0;\n"]);return yn=function(){return e},e}function gn(){var e=H(["\n  position: absolute;\n  left: 5px;\n  top: 0;\n  padding: 10px;\n  border-radius: 5px;\n  background-color: #fffdfd;\n  box-shadow: 5px 5px 20px #464646;\n  z-index: 999999;\n  min-width: 480px;\n"]);return gn=function(){return e},e}function hn(){var e=H(["\n  position: relative;\n"]);return hn=function(){return e},e}var bn=o.div(hn()),Sn=o.div(gn()),In=o.div(yn()),En=function(n){var t=n.source;return t&&e.createElement(bn,null,e.createElement(Sn,null,e.createElement("div",null,"Source: ",t.name||"Unnamed Source"),e.createElement("div",null,"Source ID: ",t.id),e.createElement(In,null,e.createElement(Z,{source:t})),e.createElement(Nn,{source:t,ContentRow:In})))},Tn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"SOURCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"Source"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"sortings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SortingFragment"},directives:[]}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"constraints"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConstraintFragment"},directives:[]}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"tree"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TreeFragment"},directives:[]}]}}]}}]}}].concat(Ne.definitions,ye.definitions,ge.definitions),loc:{start:0,end:291,source:{body:"\n  query SOURCE($id: ID!) {\n    Source(id: $id) {\n      id\n      name\n      sortings {\n        ...SortingFragment\n      }\n      types {\n        id\n        name\n      }\n      constraints {\n        ...ConstraintFragment\n      }\n      tree {\n        ...TreeFragment\n      }\n    }\n  }\n\n  \n  \n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};function An(){var e=H(["\n  direction: ltr;\n"]);return An=function(){return e},e}function Dn(){var e=H(["\n  box-sizing: border-box;\n  background-color: white;\n  color: red;\n  font-size: 16px;\n  border: 1px dashed red;\n  width: 25px;\n  height: 25px;\n  padding: 0;\n  margin: 0;\n  text-align: center;\n  text-decoration: none;\n"]);return Dn=function(){return e},e}var Cn=o.button(Dn()),wn=o.div(An()),Vn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{isTreeVisible:!1}),J(j(n),"toggleTree",function(){return n.setState(function(e){return{isTreeVisible:!e.isTreeVisible}})}),J(j(n),"setWrapperRef",function(e){n.wrapperRef=e}),J(j(n),"handleClickOutside",function(e){n.state.isTreeVisible&&n.wrapperRef&&!n.wrapperRef.contains(e.target)&&n.setState({isTreeVisible:!1})}),n}return z(i,t),M(i,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var n=this,t=this.props.id,i=this.state.isTreeVisible;return e.createElement(a,{query:Tn,variables:{id:t}},function(t){var a=t.loading,r=t.error,d=t.data;return a?null:r?"Error: ".concat(r.graphQLErrors):e.createElement(wn,{ref:n.setWrapperRef},e.createElement(Cn,{type:"button",onClick:n.toggleTree},i?"-":"+"),i&&e.createElement(En,{source:d.Source[0]}))})}}]),i}();Vn.propTypes={id:d.string.isRequired};var Fn,xn,On,Rn,_n=function(n){var t=n.id,i=n.query,r=n.typeRelationships,d=n.unrestricted,o=void 0!==d&&d,l=n.parameters,s=n.children,u={id:t,typeRelationships:JSON.stringify(r),unrestricted:o,parameters:JSON.stringify(l)},c=[{query:i,variables:u}],m=function(e){return function(n,t){var a;if(e)a=e;else{var r=t.data&&JSON.parse(t.data.ExecuteAction);a={instance:{id:r.instanceId,value:r.value,__typename:"Instance"},__typename:"InstanceWithChildren"}}var d=n.readQuery({query:i,variables:S({},u)}).sourceData;n.writeQuery({query:i,variables:S({},u),data:{sourceData:[a].concat(d)}})}},v=function(e,n){return function(t,i){var a=i.data&&JSON.parse(i.data.ExecuteAction);t.writeFragment({id:e,fragment:n,data:{id:e,value:a.value,__typename:"Instance"}})}},p=function(e){return function(n){var t=n.readQuery({query:i,variables:S({},u)}).sourceData;n.writeQuery({query:i,variables:S({},u),data:{sourceData:t.filter(function(n){return n.instance.id!==e})}})}};return e.createElement(_,null,function(n){var r=n.currentUser;return e.createElement("div",null,r&&r.role&&"MODERATOR"===r.role&&e.createElement(Vn,{id:t}),e.createElement(a,{query:i,variables:u},function(e){var n=e.loading,t=e.error,i=e.data;return s(n?{loading:n,error:t,data:i}:t?{error:t}:{error:t,data:i,loading:n,queryVariables:u,refetchQueries:c,updateSourceAfterCreateAction:m,updateSourceAfterUpdateAction:v,updateSourceAfterDeleteAction:p})}))})},$n=o.div(Fn||(Fn=T(["\n  direction: ltr;\n  position: fixed;\n  left: 0;\n  top: 0;\n  z-index: 999999;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgb(0, 0, 0, 0.8);\n"],["\n  direction: ltr;\n  position: fixed;\n  left: 0;\n  top: 0;\n  z-index: 999999;\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgb(0, 0, 0, 0.8);\n"]))),Un=o.button(xn||(xn=T(["\n  color: #007aff;\n  font-size: 0.9rem;\n  font-weight: 350;\n  background: none;\n  border: none;\n  margin: 0 0.5em;\n  padding: 0 0.2em;\n  cursor: pointer;\n\n  &:hover {\n    color: #ff6961;\n  }\n\n  &:disabled {\n    color: #dddddd;\n    cursor: default;\n  }\n\n  &::-moz-focus-inner {\n    border: 0;\n  }\n"],["\n  color: #007aff;\n  font-size: 0.9rem;\n  font-weight: 350;\n  background: none;\n  border: none;\n  margin: 0 0.5em;\n  padding: 0 0.2em;\n  cursor: pointer;\n\n  &:hover {\n    color: #ff6961;\n  }\n\n  &:disabled {\n    color: #dddddd;\n    cursor: default;\n  }\n\n  &::-moz-focus-inner {\n    border: 0;\n  }\n"]))),Pn=o.div(On||(On=T(["\n  margin: 1em;\n  padding: 1em;\n  background-color: #f0ffff;\n"],["\n  margin: 1em;\n  padding: 1em;\n  background-color: #f0ffff;\n"]))),Ln=o.span(Rn||(Rn=T(["\n  color: #c8c8c8;\n  font-size: 0.8em;\n  font-weight: 300;\n"],["\n  color: #c8c8c8;\n  font-size: 0.8em;\n  font-weight: 300;\n"]))),qn=Q(function(e){function n(){return e.exports=n=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},n.apply(this,arguments)}e.exports=n}),Mn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ActionParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Action"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"actionType"},arguments:[],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:71,source:{body:"\n  fragment ActionParts on Action {\n    id\n    name\n    actionType\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Qn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"UserClassParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserClass"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"actions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ActionParts"},directives:[]}]}}]}}].concat(Mn.definitions),loc:{start:0,end:107,source:{body:"\n  fragment UserClassParts on UserClass {\n    id\n    name\n    actions {\n      ...ActionParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Gn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"SourceParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Source"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}],loc:{start:0,end:56,source:{body:"\n  fragment SourceParts on Source {\n    id\n    name\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},jn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CollectionParts"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Collection"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}}]}}].concat(Gn.definitions),loc:{start:0,end:109,source:{body:"\n  fragment CollectionParts on Collection {\n    id\n    name\n    sources {\n      ...SourceParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Wn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{showConfirmation:!1,showDeleting:!1}),J(j(n),"showConfirmationDialog",function(){return n.setState({showConfirmation:!0})}),J(j(n),"hideConfirmationDialog",function(){return n.setState({showConfirmation:!1})}),J(j(n),"handleDelete",de(ae.mark(function e(){var t,i,a,r;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,i=t.action,a=t.userClassId,r=t.deleteAction,n.hideConfirmationDialog(),n.setState({showDeleting:!0}),e.next=5,r({variables:{id:i.id},update:function(e){var n=e.readFragment({id:a,fragment:Qn,fragmentName:"UserClassParts"});n.actions=n.actions.filter(function(e){return e.id!==i.id}),e.writeFragment({id:a,fragment:Qn,fragmentName:"UserClassParts",data:Ee({},n)})}});case 5:n.setState({showDeleting:!1});case 6:case"end":return e.stop()}},e)}))),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.state,t=n.showDeleting,i=n.showConfirmation;return t?"Deleting action...":i?e.createElement(e.Fragment,null,"Are you sure?"," ",e.createElement(Un,{type:"button",onClick:this.hideConfirmationDialog},"No")," ",e.createElement(Un,{type:"button",onClick:this.handleDelete},"Yes")):e.createElement(Un,{type:"button",onClick:this.showConfirmationDialog},"Delete")}}]),i}();Wn.propTypes={action:d.shape({id:d.string,name:d.string,actionType:d.string}).isRequired,userClassId:d.string.isRequired,deleteAction:d.func.isRequired};var Bn=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:85,source:{body:"\n  mutation DELETE_ACTION($id: ID!) {\n    DeleteAction(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"deleteAction"})(Wn);function Yn(){var e=H(["\n  margin-bottom: 0.8em;\n"]);return Yn=function(){return e},e}var zn=o.div(Yn()),Jn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{showMenu:!1}),J(j(n),"handleMouseEnter",function(){return n.setState({showMenu:!0})}),J(j(n),"handleMouseLeave",function(){return n.setState({showMenu:!1})}),J(j(n),"handleDelete",function(){}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props,t=n.action,i=n.userClassId,a=this.state.showMenu;return e.createElement(zn,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},e.createElement("div",null,t.name,a&&e.createElement(Bn,{action:t,userClassId:i})),e.createElement("div",null,e.createElement(Ln,null,t.id)))}}]),i}();Jn.propTypes={action:d.shape({id:d.string,name:d.string,actionType:d.string}).isRequired,userClassId:d.string.isRequired};var Hn={kind:"Document",definitions:function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})}([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PLATFORM_QUERY"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Platform"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"classes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserClassParts"},directives:[]}]}}]}}]}}].concat(Qn.definitions)),loc:{start:0,end:144,source:{body:"\n  query PLATFORM_QUERY($id: ID!) {\n    Platform(id: $id) {\n      id\n      name\n      classes {\n        ...UserClassParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Xn=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{showConfirmation:!1,isDeleting:!1}),J(j(n),"showConfirmation",function(){return n.setState({showConfirmation:!0})}),J(j(n),"hideConfirmation",function(){return n.setState({showConfirmation:!1,isDeleting:!1})}),J(j(n),"handleDeleteUserClass",de(ae.mark(function e(){var t,i,a,r;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,i=t.userClassId,a=t.platformId,r=t.deleteUserClass,n.setState({isDeleting:!0}),e.next=4,r({variables:{id:i},update:function(e){var n=e.readQuery({query:Hn,variables:{id:a}}).Platform;n[0].classes=n[0].classes.filter(function(e){return e.id!==i}),e.writeQuery({query:Hn,variables:{id:a},data:{Platform:n}})}});case 4:n.hideConfirmation();case 5:case"end":return e.stop()}},e)}))),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props.disabled,t=this.state,i=t.showConfirmation,a=t.isDeleting;return i?e.createElement(e.Fragment,null,"Are you sure?"," ",e.createElement(Un,{type:"button",disabled:n||a,onClick:this.hideConfirmation},"No")," ",e.createElement(Un,{type:"button",disabled:n||a,onClick:this.handleDeleteUserClass},"Yes")):e.createElement(Un,{type:"button",disabled:n,onClick:this.showConfirmation},"Delete")}}]),i}();Xn.propTypes={userClassId:d.string.isRequired,platformId:d.string.isRequired,disabled:d.bool,deleteUserClass:d.func.isRequired},Xn.defaultProps={disabled:!1};var Kn=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DELETE_USER_CLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DeleteUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:92,source:{body:"\n  mutation DELETE_USER_CLASS($id: ID!) {\n    DeleteUserClass(id: $id) {\n      id\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"deleteUserClass"})(Xn);function Zn(){var e=H(["\n  margin-top: -0.8em;\n"]);return Zn=function(){return e},e}var et=o.div(Zn()),nt={kind:"Document",definitions:function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})}([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_USERCLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"userClass"},name:{kind:"Name",value:"UpdateUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UserClassParts"},directives:[]}]}}]}}].concat(Qn.definitions)),loc:{start:0,end:150,source:{body:"\n  mutation UPDATE_USERCLASS($id: ID!, $name: String!) {\n    userClass: UpdateUserClass(id: $id, name: $name) {\n      ...UserClassParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},tt=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{showMenu:!1,showActions:!1,isEditMode:!1,isSaving:!1}),J(j(n),"handleMouseEnter",function(){return n.setState({showMenu:!0})}),J(j(n),"handleMouseLeave",function(){return n.setState({showMenu:!1})}),J(j(n),"toggleActions",function(){return n.setState(function(e){return{showActions:!e.showActions}})}),J(j(n),"handleSaveUserClass",de(ae.mark(function e(){var t,i,a,r;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,i=t.userClass,a=t.updateUserClassName,r=n.state.userClassName){e.next=4;break}return e.abrupt("return",n.setState({userClassName:i.name}));case 4:return n.setState({isSaving:!0}),e.next=7,a({variables:{id:i.id,name:r}});case 7:return n.toggleEditMode(),e.abrupt("return",n.setState({isSaving:!1}));case 9:case"end":return e.stop()}},e)}))),J(j(n),"toggleEditMode",function(){n.setState(function(e){return{isEditMode:!e.isEditMode}})}),J(j(n),"handleInputChange",function(e){e.preventDefault(),n.setState({userClassName:e.target.value})}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props,t=n.userClass,i=n.platformId,a=n.showActionView,r=n.showSourceView,d=this.state,o=d.userClassName,l=d.showMenu,s=d.showActions,u=d.isEditMode,c=d.isSaving;return e.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},e.createElement("h4",null,u?e.createElement("input",{type:"text",value:o,disabled:c,onChange:this.handleInputChange}):o,u&&e.createElement(e.Fragment,null,e.createElement(Un,{type:"button",disabled:c,onClick:this.handleSaveUserClass},"Save"),e.createElement(Un,{type:"button",disabled:c,onClick:this.toggleEditMode},"Cancel")),l&&!u&&e.createElement(e.Fragment,null,e.createElement(Un,{type:"button",onClick:this.toggleEditMode},"Edit"),e.createElement(Kn,{userClassId:t.id,platformId:i,disabled:c}),e.createElement(Un,{type:"button",onClick:this.toggleActions},s?"Hide Actions":"Show Actions"),e.createElement(Un,{type:"button",onClick:function(){return r(t.id)}},"Sources"))),e.createElement(et,null,e.createElement(Ln,null,t.id)),s&&e.createElement("div",null,e.createElement("h5",null,"Actions",e.createElement(Un,{type:"button",onClick:function(){return a(t.id)}},"Add")),e.createElement("ul",null,t.actions.map(function(n){return e.createElement("li",null,e.createElement(Jn,{key:n.id,userClassId:t.id,action:n}))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return n.prevUserClassName===e.userClass.name?null:{userClassName:e.userClass.name,prevUserClassName:e.userClass.name}}}]),i}();tt.propTypes={userClass:d.shape({id:d.string,name:d.string,actions:d.arrayOf(d.object)}).isRequired,platformId:d.string.isRequired,updateUserClassName:d.func.isRequired,showActionView:d.func.isRequired,showSourceView:d.func.isRequired};var it=s(nt,{name:"updateUserClassName"})(tt),at=function(n){var t=n.userClassName,i=n.onChange,a=n.onSubmit,r=n.onCancel;return e.createElement("form",{onSubmit:a},e.createElement(Pn,null,e.createElement("h4",null,"New User Class"),e.createElement("div",null,"User Class Name:"," ",e.createElement("input",{type:"text",placeholder:"name",onChange:i,value:t}),e.createElement(Un,{type:"submit"},"Create"),e.createElement(Un,{type:"button",onClick:r},"Cancel"))))};at.propTypes={userClassName:d.string.isRequired,onChange:d.func.isRequired,onSubmit:d.func.isRequired,onCancel:d.func.isRequired};var rt={kind:"Document",definitions:function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})}([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_USER_CLASS"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"platformId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"newUser"},name:{kind:"Name",value:"CreateUserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"platformId"},value:{kind:"Variable",name:{kind:"Name",value:"platformId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"actions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"AddCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"collectionId"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}},{kind:"Argument",name:{kind:"Name",value:"collectionName"},value:{kind:"Variable",name:{kind:"Name",value:"collectionName"}}},{kind:"Argument",name:{kind:"Name",value:"restricted"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddUserClassCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userclassid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"collectionid"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"collection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}}]}}]}}].concat(jn.definitions)),loc:{start:0,end:610,source:{body:"\n  mutation ADD_USER_CLASS(\n    $id: ID!\n    $name: String!\n    $platformId: ID!\n    $collectionId: ID!\n    $collectionName: String!\n  ) {\n    newUser: CreateUserClass(id: $id, name: $name, platformId: $platformId) {\n      id\n      name\n      actions {\n        id\n        name\n      }\n    }\n\n    AddCollection(\n      collectionId: $collectionId\n      collectionName: $collectionName\n      restricted: true\n    ) {\n      ...CollectionParts\n    }\n\n    AddUserClassCollection(userclassid: $id, collectionid: $collectionId) {\n      id\n      name\n      collection {\n        ...CollectionParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},dt=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{isFormVisible:!1,newUserClassName:"",isSubmitting:!1}),J(j(n),"showActionView",function(e){var t=n.props;(0,t.changeView)(t.views.USER_ACTION_VIEW,{userClassId:e})}),J(j(n),"showSourceView",function(e){var t=n.props;(0,t.changeView)(t.views.USER_SOURCE_VIEW,{userClassId:e})}),J(j(n),"showForm",function(){return n.setState({isFormVisible:!0,newUserClassName:""})}),J(j(n),"hideForm",function(){return n.setState({isFormVisible:!1,isSubmitting:!1})}),J(j(n),"handleFormChange",function(e){e.preventDefault(),n.setState({newUserClassName:e.target.value})}),J(j(n),"handleCreateUserClass",de(ae.mark(function e(){var t,i,a,r,d,o,l;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,i=t.platformData,a=t.addUserClass,r=n.state.newUserClassName,d=u(),o=u(),l="".concat(r," collection"),n.setState({isSubmitting:!0}),e.next=8,a({variables:{id:d,name:r,platformId:i.id,collectionId:o,collectionName:l},update:function(e,n){var t=n.data.newUser,a=e.readQuery({query:Hn,variables:{id:i.id}}).Platform;a[0].classes.push(t),e.writeQuery({query:Hn,variables:{id:i.id},data:{Platform:a}})}});case 8:n.hideForm();case 9:case"end":return e.stop()}},e)}))),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this,t=this.props.platformData,i=this.state,a=i.newUserClassName,r=i.isFormVisible,d=i.isSubmitting;return e.createElement("div",null,e.createElement("h2",null,t.name," Platform ",e.createElement(Ln,null,t.id)),e.createElement("h3",null,"User Classes",!r&&e.createElement(Un,{type:"button",onClick:this.showForm},"Add")),d?"Creating new User Class...":r&&e.createElement(at,{userClassName:a,onChange:this.handleFormChange,onSubmit:this.handleCreateUserClass,onCancel:this.hideForm}),e.createElement("ul",null,t.classes.map(function(i){return e.createElement("li",{key:i.id},e.createElement(it,{userClass:i,platformId:t.id,showActionView:n.showActionView,showSourceView:n.showSourceView}))})))}}]),i}();dt.propTypes={platformData:d.shape({id:d.string,name:d.string,classes:d.array}).isRequired,changeView:d.func.isRequired,views:d.shape({USER_ACTION_VIEW:d.string,USER_SOURCE_VIEW:d.string}).isRequired,addUserClass:d.func.isRequired};var ot=s(rt,{name:"addUserClass"})(dt);function lt(){var e=H(["\n  margin: 1.5em 0;\n  color: red;\n"]);return lt=function(){return e},e}function st(){var e=H(["\n  margin: 1.5em 0;\n"]);return st=function(){return e},e}var ut=["UPLOAD","APPROVE_UPLOAD","CONTACT","INVITE","ACCEPT_INVITATION","FIRST_LOGIN","RESPOND","NOTIFY","FOLLOW","PAY","BUY","RENT","POST","REQUEST_NEW_PASSWORD","SET_PASSWORD","LOGIN","REFRESH_USER_TOKEN","VERIFY_USER_TOKEN","CREATE_INSTANCE_WITHOUT_PARENT","CREATE_PUBLIC_INSTANCE","CREATE_INSTANCE_ASSN"],ct=o.div(st()),mt=o.div(lt()),vt=function(n){var t=n.errors,i=n.isSubmitting,a=n.onCancel;return e.createElement(m,null,e.createElement("h2",null,"New Action"),e.createElement(ct,null,e.createElement("label",{htmlFor:"actionName"},"Name:"," ",e.createElement(v,{id:"actionName",name:"actionName",placeholder:"name",disabled:i,validate:function(e){return!e&&"Name required."}}))),e.createElement(mt,null,e.createElement(p,{name:"actionName"})),e.createElement(ct,null,e.createElement("label",{htmlFor:"type"},"Type:"," ",e.createElement(v,{id:"type",name:"type",component:"select",validate:function(e){return!e&&"Please select an Action Type."},disabled:i},e.createElement("option",null),ut.map(function(n){return e.createElement("option",{key:n,value:n},n)})))),e.createElement(mt,null,e.createElement(p,{name:"type"})),e.createElement(ct,null,e.createElement("label",{htmlFor:"params"},"Params:"," ",e.createElement(v,{id:"params",name:"params",placeholder:"params",component:"textarea",rows:"10",style:{width:"80%"},disabled:i}))),e.createElement(mt,null,e.createElement(p,{name:"params"})),t&&t.length>0&&t.map(function(n){return e.createElement(mt,{key:u()},n)}),e.createElement(ct,null,e.createElement("button",{type:"submit",disabled:i},i?"Creating Action...":"Create Action")," ",e.createElement("button",{type:"button",onClick:a,disabled:i},"Cancel")))};function pt(){var e=H([""]);return pt=function(){return e},e}vt.propTypes={errors:d.arrayOf(d.string),onCancel:d.func.isRequired,isSubmitting:d.bool.isRequired},vt.defaultProps={errors:[]};var kt={kind:"Document",definitions:function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})}([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_ACTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userClassId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActionType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"newAction"},name:{kind:"Name",value:"CreateAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"userClassId"},value:{kind:"Variable",name:{kind:"Name",value:"userClassId"}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}}},{kind:"Argument",name:{kind:"Name",value:"actionParameters"},value:{kind:"Variable",name:{kind:"Name",value:"actionParameters"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ActionParts"},directives:[]}]}}]}}].concat(Mn.definitions)),loc:{start:0,end:327,source:{body:"\n  mutation CREATE_ACTION(\n    $name: String!\n    $userClassId: ID!\n    $actionType: ActionType!\n    $actionParameters: String\n  ) {\n    newAction: CreateAction(\n      name: $name\n      userClassId: $userClassId\n      actionType: $actionType\n      actionParameters: $actionParameters\n    ) {\n      ...ActionParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},ft=o.div(pt()),Nt=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{errors:[]}),J(j(n),"handleSubmit",function(){var e=de(ae.mark(function e(t,i){var a,r,d,o,l,s,u,c,m,v;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.setSubmitting,r=n.props,d=r.userClassId,o=r.createAction,l=r.returnToIndex,s=t.actionName,u=t.type,c=t.params,n.setState({errors:[]}),m=[],e.prev=5,e.next=8,o({variables:{name:s,userClassId:d,actionType:u,actionParameters:JSON.stringify(JSON.parse(c))},update:function(e,n){var t=n.data.newAction,i=e.readFragment({id:d,fragment:Qn,fragmentName:"UserClassParts"});i.actions=i.actions.concat(t),e.writeFragment({id:d,fragment:Qn,fragmentName:"UserClassParts",data:Ee({},i)})}});case 8:if(v=e.sent,v.data.newAction){e.next=12;break}throw new Error("Failed to create action.");case 12:e.next=19;break;case 14:e.prev=14,e.t0=e.catch(5),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&m.push(e.t0.graphQLErrors),e.t0.networkError&&e.t0.networkError.result&&e.t0.networkError.result.errors&&e.t0.networkError.result.errors.length&&m.push(e.t0.networkError.result.errors),e.t0.message&&m.push(e.t0.message);case 19:if(a(!1),!m.length){e.next=23;break}return n.setState({errors:m}),e.abrupt("return");case 23:l();case 24:case"end":return e.stop()}},e,null,[[5,14]])}));return function(n,t){return e.apply(this,arguments)}}()),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props.returnToIndex,t=this.state.errors;return e.createElement(ft,null,e.createElement(k,{initialValues:{actionName:"",type:"",params:""},onSubmit:this.handleSubmit,render:function(i){return e.createElement(vt,qn({},i,{errors:t,onCancel:n}))}}))}}]),i}();Nt.propTypes={returnToIndex:d.func.isRequired,userClassId:d.string.isRequired,createAction:d.func.isRequired};var yt=s(kt,{name:"createAction"})(Nt),gt=function(n){var t=n.sourceName,i=n.onChange,a=n.onSubmit,r=n.onCancel,d=n.disabled;return e.createElement("form",null,e.createElement(Pn,null,e.createElement("h4",null,"New Source"),"Name:"," ",e.createElement("input",{type:"text",value:t,onChange:i,disabled:d}),e.createElement(Un,{type:"button",onClick:a,disabled:d},"Add"),e.createElement(Un,{type:"button",onClick:r,disabled:d},"Cancel")))};gt.propTypes={sourceName:d.string.isRequired,onSubmit:d.func.isRequired,onChange:d.func.isRequired,onCancel:d.func.isRequired,disabled:d.bool.isRequired};var ht,bt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_FIRST_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddRootType"},arguments:[{kind:"Argument",name:{kind:"Name",value:"typeId"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"typeName"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"treeId"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}],loc:{start:0,end:167,source:{body:"\n  mutation CREATE_FIRST_TYPE($id: ID!, $name: String!, $treeId: ID!) {\n    AddRootType(typeId: $id, typeName: $name, treeId: $treeId) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},St=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={typeName:"",isSubmitting:!1},e.handleInputChange=function(n){return e.setState({typeName:n.target.value})},e.handleSubmit=function(n){return I(e,void 0,void 0,function(){var e,t,i,a,r,d;return E(this,function(o){switch(o.label){case 0:if(e=this.props,t=e.treeId,i=e.createFirstType,a=this.state.typeName,n.preventDefault(),!a)return[2];this.setState({isSubmitting:!0}),r=u(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i({variables:{id:r,name:a,treeId:t},update:function(e){var n=e.readFragment({id:t,fragment:ge});n.root={id:r,typeName:a},e.writeFragment({id:t,fragment:ge,data:n})}})];case 2:return o.sent(),[3,4];case 3:return d=o.sent(),console.log(d),[3,4];case 4:return this.setState({isSubmitting:!1}),[2]}})})},e}return b(t,n),t.prototype.render=function(){var n=this.state,t=n.typeName,i=n.isSubmitting;return e.createElement("div",null,e.createElement("h4",null,"Source has no types yet. Add a type first."),e.createElement("form",{onSubmit:this.handleSubmit},e.createElement("label",{htmlFor:"type-name"},"Type Name:",e.createElement("input",{id:"type-name",type:"text",value:t,onChange:this.handleInputChange,disabled:i,style:{margin:"0.5em"}})),e.createElement(Un,{type:"submit",disabled:!t||i},"Add Type")))},t}(t),It=s(bt,{name:"createFirstType"})(St),Et={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ADD_FIRST_TYPE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"typeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"AddTreeRoot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"treeid"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}},{kind:"Argument",name:{kind:"Name",value:"typeid"},value:{kind:"Variable",name:{kind:"Name",value:"typeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"root"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"id"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}}]}}]}}],loc:{start:0,end:184,source:{body:"\n  mutation ADD_FIRST_TYPE($treeId: ID!, $typeId: ID!) {\n    AddTreeRoot(treeid: $treeId, typeid: $typeId) {\n      id\n      name\n      root {\n        id\n        name\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Tt=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={selectedTypeId:null,isSubmitting:!1},e.handleSelect=function(n){e.setState({selectedTypeId:n.target.value})},e.handleCreateType=function(){return I(e,void 0,void 0,function(){var e,n,t,i;return E(this,function(a){switch(a.label){case 0:return e=this.state.selectedTypeId,n=this.props,t=n.addFirstType,i=n.treeId,this.setState({isSubmitting:!0}),[4,t({variables:{typeId:e,treeId:i}})];case 1:return a.sent(),this.setState({isSubmitting:!1}),[2]}})})},e}return b(t,n),t.prototype.render=function(){var n=this,t=this.state,i=t.selectedTypeId,r=t.isSubmitting,d=this.props,o=d.treeId,l=d.platformId;return e.createElement("div",null,e.createElement("h4",null,"Source has no types yet. Select a type to add."),e.createElement(a,{query:Te,variables:{treeId:o,platformId:l}},function(t){var i=t.loading,a=t.error,d=t.data;return i?e.createElement(e.Fragment,null,"Fetching available types..."):a?e.createElement(e.Fragment,null,"Something went wrong. Cannot fetch types."):e.createElement(ne,{options:d&&d.typesNotInTree,onSelect:n.handleSelect,disabled:r})}),e.createElement(Un,{type:"button",disabled:!i||r,onClick:this.handleCreateType},"Add Type"))},t}(t),At=c(P,s(Et,{name:"addFirstType"}))(Tt),Dt=o.div(Ct||(Ct=T(["\n  display: flex;\n  align-items: center;\n"],["\n  display: flex;\n  align-items: center;\n"])));!function(e){e[e.CREATE_NEW=0]="CREATE_NEW",e[e.ADD_EXISTING=1]="ADD_EXISTING"}(ht||(ht={}));var Ct,wt=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={mode:null},e}return b(t,n),t.prototype.render=function(){var n=this,t=this.state.mode,i=this.props.treeId;return t===ht.CREATE_NEW?e.createElement(It,{treeId:i}):t===ht.ADD_EXISTING?e.createElement(At,{treeId:i}):e.createElement(Dt,null,e.createElement("h4",null,"Source has no types yet."),e.createElement("div",null,e.createElement(Un,{type:"button",onClick:function(){return n.setState({mode:ht.CREATE_NEW})}},"Create New"),e.createElement(Un,{type:"button",onClick:function(){return n.setState({mode:ht.ADD_EXISTING})}},"Add Existing")))},t}(t);function Vt(){var e=H(["\n  margin: 1em auto;\n  padding: 1em;\n  border-radius: 3px;\n  background-color: #e6e0e0;\n  text-align: center;\n"]);return Vt=function(){return e},e}function Ft(){var e=H(["\n  margin-bottom: 0.2em;\n"]);return Ft=function(){return e},e}function xt(){var e=H(["\n  margin-bottom: 0.8em;\n"]);return xt=function(){return e},e}var Ot=o.div(xt()),Rt=o.h4(Ft()),_t=o.div(Vt()),$t=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{showMenu:!1,showControlPanel:!1,isEditMode:!1,isSaving:!1}),J(j(n),"handleMouseEnter",function(){return n.setState({showMenu:!0})}),J(j(n),"handleMouseLeave",function(){return n.setState({showMenu:!1})}),J(j(n),"toggleControlPanel",function(){return n.setState(function(e){return{showControlPanel:!e.showControlPanel}})}),J(j(n),"toggleEditMode",de(ae.mark(function e(){return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState(function(e){return{isEditMode:!e.isEditMode}});case 1:case"end":return e.stop()}},e)}))),J(j(n),"handleInputChange",function(e){e.preventDefault(),n.setState({sourceName:e.target.value})}),J(j(n),"handleSaveSourceName",de(ae.mark(function e(){var t,i,a,r;return ae.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,i=t.source,a=t.updateSourceName,r=n.state.sourceName){e.next=4;break}return e.abrupt("return",n.setState({sourceName:i.name}));case 4:return n.setState({isSaving:!0}),e.next=7,a({variables:{id:i.id,name:r}});case 7:return n.toggleEditMode(),e.abrupt("return",n.setState({isSaving:!1}));case 9:case"end":return e.stop()}},e)}))),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this.props.source,t=this.state,i=t.sourceName,r=t.isEditMode,d=t.showMenu,o=t.showControlPanel,l=t.isSaving;return e.createElement(Ot,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},e.createElement(Rt,null,r?e.createElement("input",{type:"text",value:i,disabled:l,onChange:this.handleInputChange}):i,r&&e.createElement(e.Fragment,null,e.createElement(Un,{type:"button",disabled:l,onClick:this.handleSaveSourceName},"Save"),e.createElement(Un,{type:"button",disabled:l,onClick:this.toggleEditMode},"Cancel")),d&&!r&&e.createElement(e.Fragment,null,e.createElement(Un,{type:"button",onClick:this.toggleEditMode},"Edit"),e.createElement(Un,{type:"button",onClick:this.toggleControlPanel},o?"Hide Control Panel":"Manage"))),e.createElement("div",null,e.createElement(Ln,null,n.id)),o&&e.createElement(a,{query:Tn,variables:{id:n.id}},function(n){var t=n.loading,i=n.error,a=n.data;if(t)return"Fetching Source info...";if(i)return"Error: ".concat(i.graphQLErrors);var r=a.Source[0],d=r.tree;return d?d.nodes&&Array.isArray(d.nodes)&&!(d.nodes.length<1)||d.root&&d.root.id?e.createElement("div",null,e.createElement(_t,null,e.createElement(Z,{source:r})),e.createElement(Nn,{source:r,ContentRow:_t})):e.createElement(wt,{treeId:d.id}):"Error retrieving tree."}))}}],[{key:"getDerivedStateFromProps",value:function(e,n){return n.prevSourceName===e.source.name?null:{sourceName:e.source.name,prevSourceName:e.source.name}}}]),i}();$t.propTypes={source:d.shape({id:d.string,name:d.string}).isRequired,updateSourceName:d.func.isRequired};var Ut=s({kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UPDATE_SOURCE_NAME"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UpdateSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:130,source:{body:"\n  mutation UPDATE_SOURCE_NAME($id: ID!, $name: String!) {\n    UpdateSource(id: $id, name: $name) {\n      id\n      name\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},{name:"updateSourceName"})($t),Pt=function(e){var n={};return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!n[t]&&(n[t]=!0,!0)})},Lt={kind:"Document",definitions:Pt([{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"USER_CLASS_COLLECTION"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"UserClass"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"collection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CollectionParts"},directives:[]}]}}]}}]}}].concat(jn.definitions)),loc:{start:0,end:155,source:{body:"\n  query USER_CLASS_COLLECTION($id: ID) {\n    UserClass(id: $id) {\n      id\n      name\n      collection {\n        ...CollectionParts\n      }\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},qt={kind:"Document",definitions:Pt([{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CREATE_SOURCE"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"treeId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateSource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSourceCollection"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"collectionid"},value:{kind:"Variable",name:{kind:"Name",value:"collectionId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"CreateTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"AddSourceTree"},arguments:[{kind:"Argument",name:{kind:"Name",value:"sourceid"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"treeid"},value:{kind:"Variable",name:{kind:"Name",value:"treeId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SourceParts"},directives:[]}]}}]}}].concat(Gn.definitions)),loc:{start:0,end:405,source:{body:"\n  mutation CREATE_SOURCE(\n    $id: ID!\n    $name: String!\n    $collectionId: ID!\n    $treeId: ID!\n  ) {\n    CreateSource(id: $id, name: $name) {\n      ...SourceParts\n    }\n\n    AddSourceCollection(sourceid: $id, collectionid: $collectionId) {\n      ...SourceParts\n    }\n\n    CreateTree(id: $treeId) {\n      id\n    }\n\n    AddSourceTree(sourceid: $id, treeid: $treeId) {\n      ...SourceParts\n    }\n  }\n\n  \n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},Mt=function(n){function i(){var e,n;L(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=W(this,(e=B(i)).call.apply(e,[this].concat(a))),J(j(n),"state",{newSourceName:"",isFormVisible:!1,isSubmitting:!1}),J(j(n),"showSourceForm",function(){return n.setState({isFormVisible:!0})}),J(j(n),"hideSourceForm",function(){return n.setState({isFormVisible:!1})}),J(j(n),"handleFormChange",function(e){e.preventDefault(),n.setState({newSourceName:e.target.value})}),J(j(n),"handleCreateSource",function(e){return function(){var t=de(ae.mark(function t(i){var a,r,d,o,l,s;return ae.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.state.newSourceName,r=n.props,d=r.createSource,o=r.userClassId,i.preventDefault(),l=u(),s=u(),n.setState({isSubmitting:!0}),t.next=8,d({variables:{id:l,name:a,collectionId:e,treeId:s},update:function(e){var n=e.readQuery({query:Lt,variables:{id:o}}).UserClass;n[0].collection[0].sources.push({id:l,name:a,__typename:"Source"}),e.writeQuery({query:Lt,variables:{id:o},data:{UserClass:n}})}});case 8:n.setState({isSubmitting:!1}),n.hideSourceForm();case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}),n}return z(i,t),M(i,[{key:"render",value:function(){var n=this,t=this.props,i=t.userClassId,r=t.goBack,d=this.state,o=d.isFormVisible,l=d.isSubmitting,s=d.newSourceName;return e.createElement(a,{query:Lt,variables:{id:i}},function(t){var a=t.loading,d=t.error,u=t.data;if(a)return"Loading...";if(d)return"Something went wrong.";var c=u.UserClass[0];if(!c.collection||c.collection.length<1)return e.createElement("div",{id:i},e.createElement(Un,{type:"button",onClick:r},"Back to User Class List"),e.createElement("h4",null,"Sorry, cannot read or add ",c.name,"'s Sources."));var m=c.collection[0];return e.createElement("div",{id:i},e.createElement(Un,{type:"button",onClick:r},"Back to User Class List"),e.createElement("h2",null,c.name," Sources",!o&&e.createElement(Un,{type:"button",onClick:n.showSourceForm},"Add")),o&&!l&&e.createElement(gt,{sourceName:s,onChange:n.handleFormChange,onSubmit:n.handleCreateSource(m.id),disabled:l,onCancel:n.hideSourceForm}),l&&e.createElement("div",null,"Creating new Collection..."),e.createElement("ul",null,m.sources.length>0?m.sources.map(function(n){return e.createElement("li",{key:n.id},e.createElement(Ut,{source:n}))}):e.createElement("li",null,"No sources yet.")))})}}]),i}(),Qt=s(qt,{name:"createSource"})(Mt),Gt=function(n){function i(){var e,n,t;L(this,i);for(var a=arguments.length,r=new Array(a),d=0;d<a;d++)r[d]=arguments[d];return t=W(this,(e=B(i)).call.apply(e,[this].concat(r))),J(j(t),"views",{USER_CLASS_VIEW:"USER_CLASS_VIEW",USER_ACTION_VIEW:"USER_ACTION_VIEW",USER_SOURCE_VIEW:"USER_SOURCE_VIEW"}),J(j(t),"ViewSelector",(J(n={},t.views.USER_CLASS_VIEW,ot),J(n,t.views.USER_ACTION_VIEW,yt),J(n,t.views.USER_SOURCE_VIEW,Qt),n)),J(j(t),"indexView",t.views.USER_CLASS_VIEW),J(j(t),"indexProps",t.props),J(j(t),"state",{currentView:t.views.USER_CLASS_VIEW,currentProps:t.props,history:[]}),J(j(t),"changeView",function(e,n){var i=t.state,a=i.currentView,r=i.currentProps,d=i.history;t.setState({currentView:e,currentProps:n,history:[].concat(fe(d),[{currentView:a,currentProps:r}])})}),J(j(t),"goBack",function(){var e=t.state.history;if(!(e.length<1)){var n=fe(e),i=n.pop(),a=i.currentView,r=i.currentProps;t.setState({currentView:a,currentProps:r,history:n})}}),J(j(t),"returnToIndex",function(){t.setState({currentView:t.indexView,currentProps:t.props,history:[]})}),t}return z(i,t),M(i,[{key:"render",value:function(){var n=this.state,t=n.currentView,i=n.currentProps,a=this.ViewSelector[t];return e.createElement(a,qn({},i,{changeView:this.changeView,goBack:this.goBack,returnToIndex:this.returnToIndex,views:this.views}))}}]),i}();function jt(){var e=H(["\n  overflow: scroll;\n  flex: 1;\n  padding: 5px 10px;\n  border: 1px #eeeeee solid;\n"]);return jt=function(){return e},e}function Wt(){var e=H(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  cursor: pointer;\n"]);return Wt=function(){return e},e}function Bt(){var e=H(["\n  position: relative;\n  height: 90%;\n  width: 90%;\n  min-width: 640px;\n  max-width: 960px;\n  background-color: rgb(255, 255, 255, 1);\n  padding: 1em;\n  display: flex;\n  flex-direction: column;\n"]);return Bt=function(){return e},e}var Yt=o.div(Bt()),zt=o.button(Wt()),Jt=o.div(jt()),Ht=function(n){function i(n){var t;return L(this,i),t=W(this,B(i).call(this,n)),J(j(t),"state",{}),J(j(t),"handleClickOutside",function(e){var n=t.props.onHide;t.wrapperRef&&!t.wrapperRef.current.contains(e.target)&&n()}),t.wrapperRef=e.createRef(),t}return z(i,t),M(i,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"render",value:function(){var n=this.props,t=n.onHide,i=n.platformId;return e.createElement($n,null,e.createElement(Yt,{ref:this.wrapperRef},e.createElement(zt,{type:"button",onClick:function(){return t()}},"X"),e.createElement("h1",null,"no-stack console"),e.createElement(Jt,null,e.createElement(a,{query:Hn,variables:{id:i}},function(n){var t=n.loading,i=n.error,a=n.data;return t?"Loading...":i?"Something went wrong.":a&&a.Platform?e.createElement(Gt,{platformData:a.Platform[0]}):"Failed to retrieve platform data."}))))}}]),i}();Ht.propTypes={onHide:d.func,platformId:d.string.isRequired},Ht.defaultProps={onHide:function(){}};var Xt,Kt=o.button(Zt||(Zt=T(["\n  position: fixed;\n  z-index: 999999;\n  ",": 1em;\n  bottom: 1em;\n  opacity: 0.4;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n"],["\n  position: fixed;\n  z-index: 999999;\n  ",": 1em;\n  bottom: 1em;\n  opacity: 0.4;\n  cursor: pointer;\n\n  &:hover {\n    opacity: 1;\n  }\n"])),function(e){return e.position});!function(e){e[e.left=0]="left",e[e.right=1]="right"}(Xt||(Xt={}));var Zt,ei,ni,ti,ii=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={showConsole:!1},e.handleButtonClick=function(n){n.preventDefault(),e.setState({showConsole:!0})},e.handleHideConsole=function(){e.setState({showConsole:!1})},e}return b(t,n),t.prototype.render=function(){var n=this,t=this.state.showConsole,i=this.props.position;return e.createElement(_,null,function(a){var r=a.currentUser,d=a.platformId;return r&&r.role&&"MODERATOR"===r.role?t?e.createElement(Ht,{platformId:d,onHide:n.handleHideConsole}):e.createElement(Kt,{position:i,type:"button",onClick:n.handleButtonClick},"< >"):null})},t.defaultProps={position:"left"},t}(t),ai=o.div(ei||(ei=T(["\n  max-width: 300px;\n  min-width: 200px;\n\n  padding: 1em 0;\n\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-radius: 10px 10px 10px 10px;\n  -moz-border-radius: 10px 10px 10px 10px;\n  -webkit-border-radius: 10px 10px 10px 10px;\n  -webkit-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  -moz-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n"],["\n  max-width: 300px;\n  min-width: 200px;\n\n  padding: 1em 0;\n\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-radius: 10px 10px 10px 10px;\n  -moz-border-radius: 10px 10px 10px 10px;\n  -webkit-border-radius: 10px 10px 10px 10px;\n  -webkit-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  -moz-box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n  box-shadow: 10px 10px 8px -1px rgba(0, 0, 0, 0.6);\n"]))),ri=o.div(ni||(ni=T(["\n  margin: 0.5em;\n  padding: 0.5em;\n  text-align: center;\n\n  input {\n    margin: 0 0.5em;\n  }\n"],["\n  margin: 0.5em;\n  padding: 0.5em;\n  text-align: center;\n\n  input {\n    margin: 0 0.5em;\n  }\n"]))),di=P(function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.state={username:"",password:"",isSubmitting:!1,error:""},e.handleInputChange=function(n){var t;n.preventDefault(),e.setState(((t={})[n.currentTarget.name]=n.currentTarget.value,t))},e.handleSubmit=function(n){return I(e,void 0,void 0,function(){var e,t,i,a,r;return E(this,function(d){switch(d.label){case 0:e=this.state,t=e.username,i=e.password,a=this.props.login,n.preventDefault(),this.setState({isSubmitting:!0}),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,a({username:t,password:i})];case 2:return d.sent(),[3,4];case 3:return r=d.sent(),this.setState({isSubmitting:!1,error:r.message||r.graphQLErrors}),[3,4];case 4:return[2]}})})},e}return b(t,n),t.prototype.render=function(){var n=this.props,t=n.loading,i=n.currentUser,a=n.submitButtonText,r=this.state,d=r.username,o=r.password,l=r.isSubmitting,s=r.error;return t||i?null:e.createElement(ai,null,e.createElement("form",{onSubmit:this.handleSubmit},e.createElement(ri,null,e.createElement("label",{htmlFor:"nostack-username"},"Username:",e.createElement("input",{id:"nostack-username",type:"text",name:"username",disabled:l,value:d,onChange:this.handleInputChange}))),e.createElement(ri,null,e.createElement("label",{htmlFor:"nostack-password"},"Password:",e.createElement("input",{id:"nostack-password",type:"password",name:"password",disabled:l,value:o,onChange:this.handleInputChange}))),e.createElement(ri,null,e.createElement("button",{type:"submit",disabled:l||!d||!o},a)),s&&e.createElement(ri,null,s)))},t.defaultProps={currentUser:null,submitButtonText:"Log In"},t}(t)),oi=o.button(ti||(ti=T(["\n  cursor: pointer;\n"],["\n  cursor: pointer;\n"]))),li=P(function(n){var t=n.currentUser,i=void 0===t?null:t,a=n.logout,r=n.buttonText,d=void 0===r?"Log Out":r;return i&&e.createElement(oi,{type:"button",onClick:function(){return a()}},d)}),si={region:"us-west-2",UserPoolId:"us-west-2_m5JX5p7P0",ClientId:"5uaag7pfc565c324v2r8om4tu1",identityPoolId:"us-west-2:415abfa9-619c-4ab5-aa20-c5b9ad1edbc0"},ui="https://api.matchlynx.com/graphql";function ci(e){return I(this,void 0,void 0,function(){var n,t,i,a;return E(this,function(r){switch(r.label){case 0:if(!(n=localStorage.getItem("refreshToken")))return[2,null];t=JSON.stringify({refreshToken:n,platformId:e}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,y({url:ui,method:"post",data:{query:A,variables:{actionId:"96d3be63-53c5-418e-9167-71e3d43271e3",executionParameters:t,unrestricted:!0}}})];case 2:return(i=r.sent()).data&&i.data.ExecuteAction&&((a=JSON.parse(i.data.ExecuteAction)).id&&a.AuthenticationResult&&a.AuthenticationResult.AccessToken)?(localStorage.setItem("accessToken",a.AuthenticationResult.AccessToken),[2,a.AuthenticationResult.AccessToken]):[2,null];case 3:return r.sent(),[2,null];case 4:return[2]}})})}var mi=function(e){return f(function(n,t){var i=t.headers;return I(void 0,void 0,void 0,function(){var n,t;return E(this,function(a){switch(a.label){case 0:return(n=localStorage.getItem("accessToken"))&&(t=g.decode(n,{complete:!0}))?Math.ceil(Date.now()/1e3)>=t.payload.exp?[4,ci(e)]:[3,2]:[2,{headers:i}];case 1:if(!(n=a.sent()))return localStorage.clear(),[2,{headers:i}];a.label=2;case 2:return[2,{headers:S({},i,{jwt:n})}]}})})})},vi=new N({uri:ui});export{C as ASSOCIATE_INSTANCES,si as AWS_CONFIG,D as CREATE_INSTANCE,ii as Console,V as DELETE_INSTANCE,A as EXECUTE_ACTION,di as LoginForm,li as LogoutButton,ui as NO_STACK_URI,_ as NoStackConsumer,U as NoStackProvider,Xt as Position,F as REGISTER_USER,_n as Source,w as UPDATE_INSTANCE,mi as createAuthLink,vi as httpLink,P as withNoStack};
